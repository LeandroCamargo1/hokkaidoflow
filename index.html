<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synchro - Hokkaido Flow | Controle de Produção</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif;
            background-color: #F9FAFB;
            color: #1F2937;
        }
        
        /* Estilos para gradientes Synchro */
        .synchro-gradient {
            background: linear-gradient(135deg, #4F46E5 0%, #10B981 100%);
        }
        
        .synchro-gradient-light {
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%);
        }
        
        .synchro-gradient-border {
            border-image: linear-gradient(135deg, #4F46E5, #10B981) 1;
        }
        
        .table-input {
            width: 100%;
            background-color: transparent;
            border: 1px solid #D1D5DB;
            padding: 8px;
            box-sizing: border-box;
            text-align: center;
            border-radius: 6px;
            transition: all 0.2s;
            font-family: 'Inter', sans-serif;
        }
        
        .table-input:focus {
            outline: none;
            background-color: rgba(0, 119, 194, 0.05);
            border-color: #0077C2;
            box-shadow: 0 0 0 2px rgba(0, 119, 194, 0.2);
        }
        
        .toast {
            animation: toast-in 0.5s, toast-out 0.5s 4.5s;
            transform: translateX(110%);
        }
        
        @keyframes toast-in { 
            from { transform: translateX(110%); opacity: 0; } 
            to { transform: translateX(0); opacity: 1; } 
        }
        
        @keyframes toast-out { 
            from { transform: translateX(0); opacity: 1; } 
            to { transform: translateX(110%); opacity: 0; } 
        }
        
        .loading-overlay { 
            display: flex; 
            transition: opacity 0.3s; 
        }
        
        .tab-button.active {
            border-color: #0077C2;
            color: #0077C2;
            background-color: rgba(0, 119, 194, 0.05);
        }
        
        /* Cards com cantos arredondados */
        .synchro-card {
            border-radius: 8px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            border: 1px solid #E5E7EB;
        }
        
        /* Botões com nova identidade */
        .btn-primary {
            background-color: #0077C2;
            color: white;
            font-weight: 600;
            padding: 10px 16px;
            border-radius: 6px;
            transition: all 0.2s;
        }
        
        .btn-primary:hover {
            background-color: #0066A8;
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        .btn-secondary {
            background-color: white;
            color: #0077C2;
            border: 1px solid #0077C2;
            font-weight: 600;
            padding: 10px 16px;
            border-radius: 6px;
            transition: all 0.2s;
        }
        
        .btn-secondary:hover {
            background-color: rgba(0, 119, 194, 0.05);
        }
        
        /* Cores de status */
        .status-success {
            color: #16A34A;
        }
        
        .status-warning {
            color: #F59E0B;
        }
        
        .status-error {
            color: #DC2626;
        }
        
        /* --- ESTILOS DE IMPRESSÃO --- */
        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                background-color: white;
            }
            
            .no-print {
                display: none !important;
            }
            
            .page-section {
                display: block !important;
                box-shadow: none !important;
                border: 1px solid #E5E7EB !important;
                margin-bottom: 2rem;
                page-break-inside: avoid;
            }
            
            #material-container {
                page-break-before: always;
            }
            
            .print-header {
                display: block !important;
            }
            
            @page {
                size: A4 landscape;
                margin: 0.5in;
            }
            
            table {
                font-size: 8pt;
            }
            
            th, td {
                padding: 4px 6px;
            }
            
            .container {
                padding: 0 !important;
                margin: 0 !important;
                max-width: 100% !important;
            }
        }
    </style>
</head>
<body class="bg-[#F9FAFB] text-[#1F2937]">

    <div id="toast-container" class="fixed top-5 right-5 z-[100] space-y-2 no-print"></div>

    <div class="container mx-auto p-4 md:p-6">
        <header class="mb-6 text-center no-print">
            <div class="flex flex-col items-center justify-center mb-2">
                <!-- Nova Logo Synchro -->
                <img src="https://i.postimg.cc/KvJBVwHc/Gemini-Generated-Image-gdpgb8gdpgb8gdpg.png" 
                     alt="Synchro Logo" 
                     class="h-20 w-20 object-contain mb-2">
                <h1 class="text-3xl md:text-4xl font-bold text-[#1F2937]">Synchro</h1>
                <p class="text-md text-[#6B7280] mt-1">Hokkaido Flow - Controle de PMP</p>
            </div>
        </header>
        
        <div class="flex flex-col md:flex-row justify-between items-center mb-6 p-4 bg-white synchro-card no-print">
             <div class="flex items-center gap-4">
                 <label for="date-selector" class="font-semibold text-[#374151]">Data de Produção:</label>
                 <input type="date" id="date-selector" class="border-[#D1D5DB] rounded-md p-2 bg-[#F9FAFB] focus:ring-2 focus:ring-[#0077C2]">
                 <button id="print-btn" class="btn-primary flex items-center gap-2">
                    <i data-lucide="printer"></i> Imprimir / PDF
                </button>
             </div>
             <div id="save-status" class="text-sm text-[#6B7280] font-medium h-6 flex items-center gap-2 mt-4 md:mt-0">
                 <div id="connection-status-dot" class="w-3 h-3 rounded-full bg-[#F59E0B] animate-pulse"></div>
                 <span id="connection-status-text">Conectando...</span>
             </div>
        </div>
        
        <!-- Abas de Navegação -->
        <div class="mb-6 border-b border-[#E5E7EB] no-print">
            <nav class="-mb-px flex space-x-6" aria-label="Tabs">
                <button id="tab-ciclo" data-target="#ciclo-container" class="tab-button active whitespace-nowrap py-4 px-1 border-b-2 font-medium text-lg leading-5 text-[#6B7280] hover:text-[#0077C2] hover:border-[#0077C2] focus:outline-none focus:text-[#0066A8] focus:border-[#0066A8] transition-colors duration-200">
                    Controle de Ciclo
                </button>
                <button id="tab-material" data-target="#material-container" class="tab-button whitespace-nowrap py-4 px-1 border-b-2 border-transparent font-medium text-lg leading-5 text-[#6B7280] hover:text-[#10B981] hover:border-[#10B981] focus:outline-none focus:text-[#0DA271] focus:border-[#0DA271] transition-colors duration-200">
                    Anotação de Material
                </button>
            </nav>
        </div>

        <!-- Seção 1: Controle de Ciclo e Cavitação -->
        <section id="ciclo-container" class="page-section relative bg-white p-6 synchro-card border-t-4 border-[#0077C2]">
            <div class="print-header hidden mb-4">
                <h1 class="text-xl font-bold">Relatório Diário de Produção - Synchro Hokkaido Flow</h1>
                <p class="text-sm">Data: <span class="print-date"></span></p>
            </div>
            <div class="loading-overlay hidden opacity-0 absolute inset-0 bg-white/80 justify-center items-center z-10 rounded-lg">
                <i data-lucide="loader-2" class="w-8 h-8 text-[#0077C2] animate-spin"></i>
            </div>
            <h2 class="text-2xl font-semibold text-[#0077C2] flex items-center gap-2 border-b border-[#E5E7EB] pb-4 mb-6">
                <div class="p-2 rounded-md synchro-gradient-light">
                    <i data-lucide="settings-2" class="w-5 h-5 text-[#0077C2]"></i>
                </div>
                Controle de Ciclo & Cavitação
            </h2>
            
            <div class="no-print">
                 <form id="ciclo-form">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end mb-6">
                        <div class="md:col-span-2">
                            <label for="machine-selector" class="block text-sm font-medium text-[#374151]">Selecionar Máquina para Apontar/Editar</label>
                            <select id="machine-selector" class="mt-1 block w-full p-2 border-[#D1D5DB] bg-[#F9FAFB] rounded-md shadow-sm focus:ring-[#0077C2] focus:border-[#0077C2]">
                                <option value="">-- Escolha uma máquina --</option>
                            </select>
                        </div>
                        <button id="save-ciclo-btn" type="submit" class="w-full btn-primary flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
                           <i data-lucide="save" class="w-5 h-5"></i> Salvar Dados da Máquina
                        </button>
                    </div>
                    
                    <fieldset id="ciclo-fields" disabled class="mt-6 border-t pt-6">
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div><label class="block text-sm font-medium text-[#374151]">QTD TOTAL OP</label><input data-col="qtd_total_op" type="number" class="mt-1 table-input bg-white" placeholder="Ex: 1000.5"></div>
                            <div><label class="block text-sm font-medium text-[#374151]">QTD REAL</label><input data-col="qtd_real" type="number" class="mt-1 table-input bg-white"></div>
                            <div class="md:col-span-2"><label class="block text-sm font-medium text-[#374151]">SALDO OP (FIM)</label><input data-col="fim" readonly class="mt-1 table-input bg-[#F3F4F6] font-bold"></div>

                            <div><label class="block text-sm font-medium text-[#374151]">Cód. do Produto</label><input data-col="cod_produto" type="number" class="mt-1 table-input bg-white" id="cod-produto-input"></div>
                            <div class="col-span-2 md:col-span-3"><label class="block text-sm font-medium text-[#374151]">PEÇA</label><input data-col="peca" type="text" class="mt-1 table-input bg-white text-left px-2" id="nome-peca-input"></div>
                            
                            <div><label class="block text-sm font-medium text-[#374151]">CAV.</label><input data-col="cav" type="number" class="mt-1 table-input bg-white"></div>
                            <div><label class="block text-sm font-medium text-[#374151]">CICLO</label><input data-col="ciclo" type="number" class="mt-1 table-input bg-white" placeholder="Ex: 12.5"></div>
                            <div><label class="block text-sm font-medium text-[#374151]">P.M.</label><input data-col="pm" type="number" class="mt-1 table-input bg-white" placeholder="Ex: 0.00234"></div>
                            <div><label class="block text-sm font-medium text-[#374151]">OP</label><input data-col="op" type="number" class="mt-1 table-input bg-white"></div>
                            
                            <div class="col-span-2 md:col-span-4"><label class="block text-sm font-medium text-[#374151]">MATERIAL</label><input data-col="material" type="number" class="mt-1 table-input bg-white text-left px-2"></div>
                        </div>
                    </fieldset>
                 </form>
            </div>

            <div class="mt-8 border-t pt-6">
                <h3 class="text-lg font-semibold text-[#374151] mb-4">Relatório de Lançamentos de Ciclo</h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-[#E5E7EB]">
                        <thead class="bg-[#F9FAFB]">
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">Máquina</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">Peça</th>
                                <th class="px-4 py-3 text-center text-xs font-medium text-[#374151] uppercase tracking-wider">OP</th>
                                <th class="px-4 py-3 text-center text-xs font-medium text-[#374151] uppercase tracking-wider">Qtd Total OP</th>
                                <th class="px-4 py-3 text-center text-xs font-medium text-[#374151] uppercase tracking-wider">Qtd Real</th>
                                <th class="px-4 py-3 text-center text-xs font-medium text-[#374151] uppercase tracking-wider">Saldo</th>
                                <th class="px-4 py-3 text-center text-xs font-medium text-[#374151] uppercase tracking-wider">CAV.</th>
                                <th class="px-4 py-3 text-center text-xs font-medium text-[#374151] uppercase tracking-wider">Ciclo</th>
                                <th class="px-4 py-3 text-center text-xs font-medium text-[#374151] uppercase tracking-wider">P.M.</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">Material</th>
                                <th class="px-4 py-3 text-center text-xs font-medium text-[#374151] uppercase tracking-wider no-print">Ações</th>
                            </tr>
                        </thead>
                        <tbody id="tabela-ciclo-body" class="bg-white divide-y divide-[#E5E7EB]"></tbody>
                    </table>
                </div>
            </div>
            
            <div class="mt-8 border-t pt-6">
                <label for="observacoes" class="block text-md font-semibold text-[#374151] no-print">Observações Gerais do Dia:</label>
                <textarea id="observacoes" rows="3" class="mt-2 block w-full p-3 border border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#0077C2] focus:border-[#0077C2] no-print" placeholder="Observações relevantes sobre o turno, máquinas ou materiais..."></textarea>
                 <div class="print:block hidden mt-4">
                    <h3 class="text-lg font-semibold text-[#374151]">Observações:</h3>
                    <p id="print-observacoes" class="text-sm border p-2 rounded-md bg-[#F9FAFB] h-24"></p>
                </div>
            </div>
        </section>

        <!-- Seção 2: Anotação de Material Preparado -->
        <section id="material-container" class="page-section hidden relative bg-white p-6 synchro-card border-t-4 border-[#10B981]">
             <div class="loading-overlay hidden opacity-0 absolute inset-0 bg-white/80 justify-center items-center z-10 rounded-lg">
                <i data-lucide="loader-2" class="w-8 h-8 text-[#10B981] animate-spin"></i>
             </div>
             <h2 class="text-2xl font-semibold text-[#10B981] border-b border-[#E5E7EB] pb-4 mb-6">
                <div class="p-2 rounded-md bg-[#ECFDF5] inline-flex mr-2">
                    <i data-lucide="box" class="w-5 h-5 text-[#10B981]"></i>
                </div>
                Anotação de Material Preparado
            </h2>
             <form id="form-material" class="bg-[#F9FAFB] p-6 rounded-md border border-[#E5E7EB] mb-8 no-print">
                 <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                    <div>
                        <label for="preparador" class="block text-sm font-medium text-[#374151]">Preparador</label>
                        <select id="preparador" required class="mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]">
                            <option value="">Selecione</option>
                        </select>
                    </div>
                    <div>
                        <label for="maquina-prep" class="block text-sm font-medium text-[#374151]">Máquina</label>
                        <select id="maquina-prep" required class="mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]">
                            <option value="">Selecione</option>
                        </select>
                    </div>
                    <div><label for="cod-produto-material" class="block text-sm font-medium text-[#374151]">Cód. do Produto</label><input type="text" id="cod-produto-material" class="mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]"></div>
                    <div class="sm:col-span-2 lg:col-span-1"><label for="nome-peca" class="block text-sm font-medium text-[#374151]">Nome da Peça</label><input type="text" id="nome-peca" required class="bg-white mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]"></div>
                    <div><label for="op-prep" class="block text-sm font-medium text-[#374151]">OP</label><input type="text" id="op-prep" class="bg-white mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]"></div>
                    <div><label for="qtd-mat" class="block text-sm font-medium text-[#374151]">Qtd. Mat.</label><input type="number" id="qtd-mat" class="mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]"></div>
                    <div><label for="sk-resina" class="block text-sm font-medium text-[#374151]">SK Resina</label><input type="text" id="sk-resina" class="mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]"></div>
                    <div><label for="lote-resina" class="block text-sm font-medium text-[#374151]">Lote Resina</label><input type="text" id="lote-resina" class="mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]"></div>
                    <div><label for="sk-master" class="block text-sm font-medium text-[#374151]">SK Master</label><input type="text" id="sk-master" class="mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]"></div>
                    <div><label for="sk-aditivo" class="block text-sm font-medium text-[#374151]">SK Aditivo</label><input type="text" id="sk-aditivo" class="mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]"></div>
                    <div><label for="lote-master" class="block text-sm font-medium text-[#374151]">Lote Master</label><input type="text" id="lote-master" class="mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]"></div>
                    <div><label for="lote-adit" class="block text-sm font-medium text-[#374151]">Lote Adit.</label><input type="text" id="lote-adit" class="mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]"></div>
                    <div><label for="percent-usado" class="block text-sm font-medium text-[#374151]">% Usado</label><input type="number" step="0.001" id="percent-usado" class="mt-1 block w-full p-2 border-[#D1D5DB] rounded-md shadow-sm focus:ring-[#10B981] focus:border-[#10B981]"></div>
                 </div>
                 <div class="mt-6 text-right">
                    <button type="submit" class="btn-primary bg-[#10B981] hover:bg-[#0DA271] flex items-center gap-2">
                        <i data-lucide="plus-circle" class="w-5 h-5"></i> Adicionar Registro
                    </button>
                 </div>
             </form>
             <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-[#E5E7EB]">
                    <thead class="bg-[#F9FAFB]">
                        <tr>
                            <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">Preparador</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">Máquina</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">Cód. Prod.</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">OP</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">Nome da Peça</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">Qtd. Mat.</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">SK Resina</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">Lote Resina</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">SK Master</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">Lote Master</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">SK Aditivo</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-[#374151] uppercase tracking-wider">Lote Adit.</th>
                            <th class="px-4 py-3 text-center text-xs font-medium text-[#374151] uppercase tracking-wider">% Usado</th>
                            <th class="px-4 py-3 text-center text-xs font-medium text-[#374151] uppercase tracking-wider no-print">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="tabela-material-body" class="bg-white divide-y divide-[#E5E7EB]"></tbody>
                </table>
             </div>
        </section>
    </div>
    
    <div id="confirm-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center no-print">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm m-4 text-center">
            <div class="flex justify-center mb-4">
                <div class="w-12 h-12 bg-[#FEF3C7] rounded-full flex items-center justify-center">
                    <i data-lucide="alert-triangle" class="w-8 h-8 text-[#F59E0B]"></i>
                </div>
            </div>
            <h3 class="text-lg font-bold text-[#1F2937]">Tem certeza?</h3>
            <p class="text-sm text-[#6B7280] my-2" id="confirm-modal-text"></p>
            <div class="mt-6 flex justify-center gap-3">
                <button id="confirm-modal-cancel-btn" class="btn-secondary">Cancelar</button>
                <button id="confirm-modal-ok-btn" class="btn-primary bg-[#DC2626] hover:bg-[#B91C1C]">Confirmar Exclusão</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, addDoc, deleteDoc, onSnapshot, collection, query, where, serverTimestamp, writeBatch, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- INÍCIO DA CONFIGURAÇÃO DO FIREBASE ---
        const firebaseConfig = {
          apiKey: "AIzaSyBm1x7UJwJafQkeffshu19SbR05cE5cVMw",
          authDomain: "pmphokkaido.firebaseapp.com",
          projectId: "pmphokkaido",
          storageBucket: "pmphokkaido.appspot.com",
          messagingSenderId: "51980668621",
          appId: "1:51980668621:web:1f076cd52c7dd56ac6a384"
        };
        // --- FIM DA CONFIGURAÇÃO DO FIREBASE ---

        const appId = firebaseConfig.projectId;

        let db, auth, userId;
        let selectedDate = new Date().toISOString().split('T')[0];
        let materialUnsubscribe = () => {};
        let cicloData = { maquinas: {}, observacoes: '' };
        
        // Base de dados de produtos do PDF
        const produtosDatabase = {
            "2": "ROSCA BAIXA P2000 28 400 ESTRIADA AZUL CB047 DP8064 - FT120",
            "3": "ROSCA BAIXA P2000 28 400 ESTRIADA BRANCO 767 DP8064 - FT120 - 5180921",
            "4": "ROSCA BAIXA P2000 28 400 ESTRIADA OURO CB101 DP8064 - FT120 - 5180974",
            "5": "ROSCA BAIXA P2000 28 400 ESTRIADA PRETO DP8064 - FT120 - 5180922",
            "6": "ROSCA ALTA P2000 28 410 FOSCA BRANCA CB124 EF063 - FT120 - 5181103",
            "7": "ROSCA ALTA P2000 28 410 FOSCA BRANCA 767 EF063 - 5180923",
            "9": "ROSCA ALTA P2000 28 410 FOSCA OURO CB149 EF063 - FT120 - 5181192",
            "10": "ROSCA ALTA P2000 28 410 FOSCA OURO CB078 EF063 - FT120 - 5180930",
            "11": "ROSCA ALTA P2000 28 410 FOSCA PRATA CB132 EF063 - 5181153",
            "12": "ROSCA ALTA P2000 28 410 ESTRIADA NATURAL PP EF062 - 5181020",
            "13": "ROSCA ALTA P2000 28 410 ESTRIADA VERMELHO CB122 PP EF062 - 5181080",
            "14": "ROSCA ALTA P2000 28 410 ESTRIADA BRANCA 767 PP DP8062 - FT120 - 5188188",
            "15": "ROSCA ALTA P2000 28 410 FOSCO AZUL CB150 PP COPOLÍMERO EF063 - 5183994",
            "16": "ROSCA ALTA P2000 28 410 FOSCA NATURAL PP COPOLIMERO EF063 - 5180929",
            "17": "ROSCA ALTA P2000 28 410 FOSCA PRETO 017 PP COPOLÍMERO EF063 - 5179141",
            "20": "ROSCA P2000 24 410 LISA BRANCO PEROLA CB155 DP8061 - RP347 - 5183999",
            "21": "ANEL TRAVA P2000 STD AZUL CB47 BRILHANTE PP DP8038 - 5180951",
            "22": "ANEL TRAVA P2000 STD AZUL CB103 BRILHANTE PP DP8038",
            "23": "ANEL TRAVA P2000 STD LILAS CB106 BRILHANTE PP DP8038",
            "24": "ANEL TRAVA P2000 STD NATURAL BRILHANTE PP DP8038 - 5181036",
            "25": "ANEL TRAVA P2000 STD OURO CB101 BRILHANTE PP DP8038 - 5180952",
            "26": "ANEL TRAVA P2000 STD ROSA CB107 BRILHANTE PP DP8038",
            "27": "ANEL TRAVA P2000 STD ROXO CB99 BRILHANTE PP DP8038",
            "30": "ANEL TRAVA P2000 STD VERMELHO CB98 BRILHANTE PP DP8038",
            "31": "ANEL TRAVA P2000 STD AZUL CB150 PP TEXT DP8038 - 5183993",
            "32": "ANEL TRAVA P2000 STD BRANCO 767 PP TEXT DP8038 - 5180948",
            "33": "ANEL TRAVA P2000 STD BRANCO CB124 PP TEXT DP8038 - 5181104",
            "34": "ANEL TRAVA P2000 STD LARANJA CB119 PP TEXT DP8038",
            "35": "ANEL TRAVA P2000 STD OURO CB78 PP TEXT DP8038 - 5180947",
            "37": "ANEL TRAVA P2000 STD OURO CB149 PP TEXT DP8038 - 5181193",
            "38": "ANEL TRAVA P2000 STD PRATA CB132 PP TEXT DP8038 - 5181155",
            "39": "ANEL TRAVA P2000 STD PRETO 17 PP TEXT DP8038 - 5179120",
            "41": "ANEL TRAVA P2000 STD ROSA CB120 PP TEXT DP8038",
            "42": "ANEL TRAVA P2000 STD VERMELHO CB122 PP TEXT DP8038 - 5181081",
            "43": "ANEL TRAVA P2000 STD VERDE CB121 PP TEXT DP8038",
            "46": "PISTÃO P2000 ROD PRINC AZUL CB47 PP DP8044 - 5181025",
            "47": "PISTÃO P2000 ROD PRINC AZUL CB150 PP DP8044 - 5183995",
            "48": "PISTÃO P2000 ROD PRINC BRANCO 767 PP DP8044 - 5180916",
            "49": "PISTÃO P2000 ROD PRINC BRANCO PÉROLA PP CB155 DP8044 - 5186132",
            "50": "PISTÃO P2000 ROD PRINC LARANJA CB119 PP DP8044 - 5181090",
            "52": "PISTÃO P2000 ROD PRINC NATURAL PP DP8044 - 5180936",
            "53": "PISTÃO P2000 ROD PRINC OURO CB78 PP DP8044 - 5180937",
            "54": "PISTÃO P2000 ROD PRINC OURO CB101 PP DP8044 - 5180938",
            "55": "PISTÃO P2000 ROD PRINC OURO CB149 PP DP8044 - 5181195",
            "56": "PISTÃO P2000 ROD PRINC PRATA CB132 PP DP8044 - 5181156",
            "57": "PISTÃO P2000 ROD PRINC PRETO 017 PP DP8044 - 5179138",
            "62": "PISTÃO P2000 ROD PRINC VERDE CB121 PP DPB044 - 5184017",
            "65": "PISTÃO P2000 ROD PRINC VERMELHO CB122 PP DPB044 - 5181083",
            "67": "ATUADOR P2000 SATIN AZUL BEBÉ CB103 PP DPB039 - 5181040",
            "68": "ATUADOR P2000 SATIN AZUL CB47 PP DPB039 - 5180942",
            "69": "ATUADOR P2000 SATIN AZUL CB150 PP DPB039 - 5183996",
            "70": "ATUADOR P2000 SATIN BRANCO 767 PP DPB039 - 5180855",
            "71": "ATUADOR P2000 SATIN BRANCO CB124 PP DPB039 - 5181105",
            "72": "ATUADOR P2000 SATIN BRANCO PEROLA P CB155 PP DPB039 - 5183997",
            "73": "ATUADOR P2000 SATIN LARANJA CB119 PP DPB039 - 5181089",
            "74": "ATUADOR P2000 SATIN LLÁS CB106 PP PP DPB039 - 5180944",
            "75": "ATUADOR P2000 SATIN NATURAL PP DPB039 - 5180939",
            "76": "ATUADOR P2000 SATIN OURO CB78 PP DPB039 - 5180963",
            "77": "ATUADOR P2000 SATIN OURO CB101 PP DPB039 - 5180943",
            "78": "ATUADOR P2000 SATIN OURO CB149 PP DPB039 - 5181194",
            "79": "ATUADOR P2000 SATIN PRATA CB132 PP DPB039 - 5181154",
            "80": "ATUADOR P2000 SATIN PRETO 17 PP DPB039 - 5179121",
            "82": "ATUADOR P2000 SATIN ROSA CB107 PP DPB039 - 5180945",
            "83": "ATUADOR P2000 SATIN ROSA CB120 PP DPB039 - 5181093",
            "84": "ATUADOR P2000 SATIN ROXO CB99 PP DPB039 - 5180941",
            "85": "ATUADOR P2000 SATIN VERDE CB121 PP DPB039 - 5181086",
            "86": "ATUADOR P2000 SATIN VERMELHO CB98 PP DPB039 - 5180940",
            "88": "ATUADOR P2000 SATIN VERMELHO CB122 PP DPB039 - 5181082",
            "90": "PLUG P2000 STANDARD NATURAL PP EF073 - H301 - 5179139",
            "91": "BUCHA P2000 ZML NATURAL PP - 5179122",
            "92": "ACUMULADOR P2000 28MM NAT PP EF045 - H301 - 5179118",
            "93": "ACUMULADOR P2000 JUNTA-A NATURAL EF045 - VERSÃO A - H301 - 5181044",
            "94": "TAMPA MKIV MD STD NATURAL PP PD06001 - 5179142",
            "97": "RETENTOR MKIV MD M300 STD NAT POM DF002 - 24 CAVIDADES - 5179163",
            "98": "ACUMULADOR MKIV MD STANDAR NAT PP (ESPANHOL. INTERNO) - H301 - 5179119",
            "99": "ACUMULADOR MKIV MD STAND NAT PP - 5181076 (ESPANHOL. EXTERNO)",
            "102": "ATUADOR MKIV STD AZUL CB72 PP Q1PD06002 - 5180962 (ATUAD. SPRAY)",
            "103": "ATUADOR MKIV STD BRANCO 767 PP Q1PD06002 - 5180856 (ATUADOR SPRAY)",
            "104": "ATUADOR MKIV STD BRANCO ANIL PP Q12PD06002 - 5181043 (ATUADOR SPRAY)",
            "105": "ATUADOR MKIV STD BRANCO CB124 PP Q1PD06002 - 5181118 (ATUADOR SPRAY)",
            "108": "ATUADOR MKIV STD MARROM CB142 PP Q1PD06002 - 5179160 (ATUADOR SPRAY)",
            "109": "ATUADOR MKIV STD NATURAL PP Q1PD06002 - 5180858 (ATUADOR SPRAY)",
            "111": "ATUADOR MKIV STD PRETO 17 PP Q1PD06002 - 5180976 (ATUADOR SPRAY)",
            "112": "ATUADOR MKIV STD ROSA CB79 PP Q1PD06002 - 5180859 (ATUADOR SPRAY)",
            "113": "ATUADOR MKIV STD ROXO CB139 PP Q1PD06002 - 5181132 (ATUADOR SPRAY)",
            "114": "ATUADOR MKIV STD ROXO CB144 PP Q1PD06002 - 5181172 (ATUADOR SPRAY)",
            "115": "ATUADOR MKIV STD VERDE CB06 PP Q1PD06002 - 5180961 (ATUADOR SPRAY)",
            "120": "ATUADOR MD STD BRANCO 767 PE - 5180991 (DIF. DISP.)",
            "121": "ATUADOR MD STD BRANCO CB155 PE Q1PD06003 - 5184012 (DIF. DISP.)",
            "125": "ATUADOR MD STD PRETO PE Q1PD06003 - 5181119 (DIF. DISP.)",
            "126": "ATUADOR MD STD OURO CB112 PE Q1PD06003 - 5179150 (DIF. DISP.)",
            "128": "ATUADOR MD STD ROXO CB139 PE Q1PD06003 - 5181134 (DIF. DISP.)",
            "129": "ATUADOR MD STD VERDE CB06 PE Q1PD06003 - 5181037 (DIF. DISP.)",
            "135": "ROSCA MKIV MD 18 415 LISA OURO CB49 PP Q2PD06007 - 5181021",
            "139": "ROSCA MKIV MD 20 410 ESTRIADA AMARELO CB63 PP Q5PD06007 - 5181006",
            "140": "ROSCA MKIV MD 20 410 ESTRIADA BRANCO 767 PP Q5PD06007 - 5184914",
            "141": "ROSCA MKIV MD 20 410 ESTRIADA BRANCO ANIL 2902 PP 05PD06007 - 5181009",
            "143": "ROSCA MKIV MD 20 410 ESTRIADA ROXO CB105 PP 05PD06007 - 5181222",
            "146": "ROSCA MKIV MD 20 410 LISA BRANCA 767 PP 06PD06007 - 5181097",
            "148": "ROSCA MKIV MD 20 410 LISA MARRONA CB142 PP 06PD06007 - 5179159",
            "149": "ROSCA MKIV MD 20 410 LISA NATURAL PP 06PD06007 - 5181046",
            "150": "ROSCA MKIV MD 20 410 LISA PRETO PP 06PD06007 - 5181010",
            "151": "ROSCA MKIV MD 20 410 LISA ROXO CB139 PP 06PD06007 - 5181133",
            "153": "ROSCA MKIV MD 22 415 ESTRIADA OURO CB112 PP 09PD06007 - 5179158",
            "154": "ROSCA MKIV MD 22 415 ESTRIADA PRETO 017 PP 09PD06007 - 5181011",
            "161": "ROSCA MKIV MD 24 410 ESTRIADA BRANCO 767 PP 13PD06007 - 5180925",
            "162": "ROSCA MKIV MD 24 410 ESTRIADA BRANCO CB155 PP 13PD06007 - 5184013",
            "163": "ROSCA MKIV MD 24 410 ESTRIADA NATURAL PP 13PD06007 - 5181008",
            "164": "ROSCA MKIV MD 24 410 ESTRIADA ROXO CB144 PP 13PD06007 - 5181171",
            "165": "ROSCA MKIV MD 24 410 ESTRIADA ROSA CB79 PP 13PD06007 - 5180924",
            "166": "ROSCA MKIV MD 24 410 LISA AZUL CB72 PP 13 PD06007 - 5181023",
            "167": "ROSCA MKIV MD 24 410 LISA BRANCO 767 PP 13 PD06007 - 5183989",
            "168": "ROSCA MKIV MD 24 410 LISA BRANCO CB124 PP 13 PD06007 - 5181117",
            "171": "ROSCA MKIV MD 24 410 LISA PRETA 17 PP PD06007 - 5196907",
            "172": "ROSCA MKIV MD 24 410 LISA ROXO CB139 - 5181131",
            "175": "RETENTOR M300 STD NAT POM DF002 - 64 CAVIDADES - 5179140",
            "176": "ACUMULADOR M300 STANDARD NAT PP DG007 - FT120 - 5179117",
            "178": "PISTÃO M300 STD PRINC NAT PEBD DPB075 - RESINA NACIONAL - 5179156",
            "180": "ROSCA M300 GL18 ESTRIADO AMARELO CB131 PP DPB072 - 5181113",
            "181": "ROSCA M300 GL18 ESTRIADO BEGE CB143 PP DPB072 - 5181164",
            "182": "ROSCA M300 GL18 ESTRIADO BRANCO 767 PP DPB072 - 5179146",
            "183": "ROSCA M300 GL18 ESTRIADO LARANJA CB80 PP DPB072 - 5180919",
            "184": "ROSCA M300 GL18 ESTRIADO LARANJA CB097 PP DPB072 - 5183693",
            "185": "ROSCA M300 GL18 ESTRIADO LARANJA CB146 PPDPB072 - 5181180",
            "188": "ROSCA M300 GL18 ESTRIADO LLÁS CB151 PP DPB072 - 5181227",
            "189": "ROSCA M300 GL18 ESTRIADO ROSA CB136 PP DPB072 - 5181124",
            "190": "ROSCA M300 GL18 ESTRIADO ROSA CB133 PP DPB072 - 5181120",
            "191": "ROSCA M300 GL18 ESTRIADO VERMELHO CB152 PP DPB072 - 5183990",
            "192": "ROSCA M300 GL18 ESTRIADO VERMELHO CB140 PP DPB 072 - 5181141",
            "193": "ROSCA M300 GL18 ESTRIADO VERMELHO CB77 PP DPB072 - 5181022",
            "194": "ATUADOR M300 AMARELO CB131 STD PP DPB007 - FT120 - 5181114",
            "195": "ATUADOR M300 BEGE CB143 STD PP DPB007 - FT120 - 5181165",
            "196": "ATUADOR M300 BRANCO CB48 STD PP DPB007 - FT120 - 5179149",
            "197": "ATUADOR M300 LARANJA CB146 STD PP DPB007 - FT120 - 5181179",
            "198": "ATUADOR M300 LLÁS CB151 STD PP DPB007 - FT120 - 5181228",
            "202": "ATUADOR M300 VERMELHO CB152 STD PP DPB007 - FT120 - 5183992",
            "203": "ATUADOR M300 VERMELHO CB140 STD PP DPB007 - 5181142",
            "204": "ATUADOR M300 VERMELHO CB77 STD PP DPB007 - FT120 - 5181045",
            "206": "CAPSULA MELODIE CLIKIT 17 NAT PP DP054 - 5180934",
            "207": "CAPSULA MELODIE CLIKIT 18 NAT PP DPB056 - 5180874",
            "210": "SUPORTE REDONDO BRANCO - 753 200-000",
            "211": "SUPORTE REDONDO CINZA - 753 300-000",
            "212": "SUPORTE REDONDO PRETO",
            "213": "BOCAL 12",
            "214": "BOCAL 13",
            "215": "BOCAL 14",
            "216": "BOCAL I5",
            "217": "BOCAL I6",
            "219": "SUPORTE CURVO DA MANGUEIRA COM PINO BRANCO",
            "220": "SUPORTE CURVO DA MANGUEIRA COM PINO CINZA",
            "221": "BICO DE ENTRADA BRANCO (ESPIGÃO)",
            "222": "BICO DE ENTRADA CINZA (ESPIGÃO)",
            "223": "SUPORTE REDONDO 1\" BRANCO",
            "224": "SUPORTE REDONDO 1\" CINZA",
            "225": "SUPORTE REDONDO 1\" PRETO",
            "226": "FIXAÇÃO-GS-28/410CUST-28-THREAD-HDPE-WH - 29032088",
            "228": "TAMPA SERINGA PRETO",
            "234": "CARRETEI - GERDAU",
            "235": "CARRETEI - OVD (SEM INSCRIÇÃO)",
            "236": "CLIP AZUL 2945C (NACIONAL) - 30002026",
            "237": "CONECTOR AMARELO 17MS - 30002192",
            "238": "CONECTOR AZUL 75 MS",
            "239": "SHELL PLASTIC EXEL™ WHITE 42MS (CONECT. BRANCO) - 1002042",
            "240": "CONECTOR LARANJA 42 MS - 30002197",
            "241": "CONECTOR PRETO 300 MS",
            "242": "CONECTOR VERDE 9 MS - 30002200",
            "243": "CORPO PLAST EXEL MS/DCD (COR VERME 25MS) - 1002047",
            "244": "CONECTOR VIOLETA 200 MS - 30002201",
            "245": "CLIP AZUL 2945C (EXPORTAÇÃO) - 30002026",
            "246": "CONECTOR AMARELO 17 MS (EXPORTAÇÃO)",
            "247": "CONECTOR AZUL 75 MS (EXPORTAÇÃO)",
            "248": "CONECTOR BRANCO 100 MS (EXPORTAÇÃO)",
            "249": "CONECTOR LARANJA SEM NUMERAÇÃO (EXPORTAÇÃO)",
            "250": "CONECTOR PRETO 300 MS (EXPORTAÇÃO)",
            "252": "CONECTOR VERDE 9 MS (EXPORTAÇÃO)",
            "253": "CONECTOR VERMELHO 25 MS (EXPORTAÇÃO)",
            "254": "CONECTOR VIOLETA 200 MS (EXPORTAÇÃO)",
            "255": "TAMPA SUPERIOR PARA FILTRO - 285058449",
            "256": "TAMPA INFERIOR PARA FILTRO - 285058439",
            "257": "TAMPA PLÁSTICA SEM FURO - 285058389",
            "258": "TAMPA PLÁSTICA COM FURO - 285058399",
            "259": "BOCAL PARA FILTRO DE ÓLEO - 207803839",
            "260": "PISTÃO PARA FILTRO DE ÓLEO - 275410349",
            "261": "TAMPA PLÁSTICA 5831 - 285058311",
            "262": "COROA PARA FILTRO DE ÓLEO - 219900509",
            "263": "ADAPTADOR - 204900818",
            "264": "SUPORTE PLÁSTICO SÉRIE 600 ESCAL (COM ABA) - 283600949",
            "265": "SUPORTE PLASTICO SERIE R260 (SEM ABA) - 283600939",
            "266": "PLUG 1/4 - 225 PARA FILTRO DE ÓLEO - 275410029",
            "267": "TAMPA PLÁSTICA 4 CAVIDADES - 285058959",
            "268": "TAMPA PLÁSTICA 5923 - 285059079",
            "269": "SUPORTE DO COPO - 6 CAVIDADES - NYLON - 283600909",
            "270": "SUPORTE DO COPO - 4 CAVIDADES - TECHNYL - 283600909",
            "271": "SUPORTE DO COPO - 6 CAVIDADES - TECHNYL - 283600909",
            "272": "SUPORTE DO COPO - 4 CAVIDADES - NYLON - 283600909",
            "273": "TAMPÃO PLÁSTICO AMARELO (MONTADO) P/ FILTRO DE OLEO - 485500068",
            "274": "TAMPÃO PLÁSTICO NATURAL (MONTADO) P/ FILTRO DE OLEO - 485500038",
            "275": "PUXADOR COM BOMBA - 445500078",
            "276": "PLUG 1/2\" 225 P/ F OLEO COM ORING - 475400188",
            "277": "CONICO FILTRO OLEO - 219910309",
            "278": "TURBINA (MONTADA) P/ FILTRO DE ÓLEO - 293900009",
            "279": "CONJUNTO TAMPÃO (MONTADO) - 485500078",
            "280": "PLUG DO DRENO + VEDADOR - 475400128",
            "282": "SUBCONJUNTO DRENO (MONTADO) - 475400248",
            "283": "SUPORTE USINADO - 283601039",
            "289": "PAINEL FRONTAL MODULADOR RETANGULAR",
            "436": "CLIP PLASTICO PP-RND DS25 K2/F3 OURO (MODIF) - 29029923",
            "437": "ATUADOR_CAP-KAJAK--PP-BLUE-MATT--ESSEN - 8 CAV - 29029484",
            "438": "CAPA KAJAK 8 CAV PRETO BEM 09335 ESSENCIA - ATUADOR_CAP-KAJAK-29029497",
            "439": "ATUADOR_CAP-KAJAK--PP-ORAN-MATT--ESSEN - 8 CAV - 29029488",
            "440": "ATUADOR_CAP-KAJAK--PP-GREE-MATT--ESSEN - 8 CAV - 29029495",
            "441": "CLIP PLASTICO PP-RND MA00 K2/F3 PRETO (MODIF) - 29029916",
            "442": "CCLIPE-K--PP-NATU--RRNA00004--- 10303988",
            "443": "ATUADOR_CAP-KAJAK--PP-BLUE-MATT--ESSEN - 16 CAV - 29029484",
            "444": "ATUADOR_CAP-KAJAK--PP-BLAC-MATT--ESSEN - 16 CAV - 29029497",
            "445": "ATUADOR_CAP-KAJAK--PP-ORAN-MATT--ESSEN - 16 CAV - 29029488",
            "446": "ATUADOR_CAP-KAJAK--PP-GREE-MATT--ESSEN - 16 CAV - 29029495",
            "447": "ATUADOR_CAP-KAJAK--PP-WHIT-MATT--ESSEN - 16 CAV - 29029501",
            "448": "ATUADOR_CAP-KAJAK--PP-WHIT-MATT--ESSEN - 8 CAV - 29029501",
            "449": "ATUADOR_CAP-KAJAK--PP-RED-MATT- ES37--ES - 16 CAV - 29029494",
            "450": "ATUADOR_CAP-KAJAK--PP-RED-MATT- ES37--ES - 8 CAV - 29029494",
            "451": "ATUADOR_CAP-KAJAK--PP-NATU-MATT- NT1954 - 16 CAV - 29029912",
            "452": "ATUADOR-EMII-PP--4,34-NATU--SPRAY--- 29025910",
            "453": "ATUADOR-EMII-PP--4,34-BLAC--SPRAY--MS06 - 29025904",
            "454": "ATUADOR-EMII-PP--4,34-BLUE--SPRAY--KS24 - 29032105",
            "455": "ATUADOR EM CLASSIC SPRAY VERDE - 31135179",
            "456": "ATUADOR-EMII-PP--4,34-BROW--SPRAY--HS11 - 29032438",
            "457": "TAMPA-EM-28,20-PP-NATU--SHNY---EM STD - 10603918",
            "458": "TAMPA-EM-28,20-PP-BLAC--SHNY--- 29029431",
            "459": "ATUADOR-EMII-PP--4,34-ORAN-SHNY--SPRAY-- 29001643",
            "464": "ATUADOR-EMII-PP--4,34-WHIT--SPRAY--- 29025986",
            "470": "ATUADOR M300 MARROM CB156 STD PP DPBO07 - FT120 - 5184002",
            "472": "ATUADOR M300 ROSA CB157 STD PP DPBO07 - 5184005",
            "473": "ROSCA M300 GL18 ESTRIADO MARROM CB156 PP DPBO728 - 5184001",
            "477": "CLIP PLASTICO BRANCO CA01 K2/F3 - CLIPE-K--PP-WHIT-CA01-- 29025725",
            "478": "ATUADOR EM CLASSIC SPRAY PINK - ATUADOR-EMII-PP--4,34-PINK--- 29025949",
            "490": "TAMPA SERINGA INCOLOR",
            "518": "ROSCA M300 GL18 ESTRIADO ROSA CB157 PP DPBO72 - 5184004",
            "534": "ACT EM CLASSIC PP MINT GREEN 1702395-SE - 31134205",
            "539": "ROSCA M300 GL18 ESTRIADO ROSA ESCURO CB158 PP DPBO72 - 5184007",
            "540": "ATUADOR M300 ROSA ESCURO CB158 STD PP DPBO07 - FT120 - 5184008",
            "541": "ATUADOR M300 VIOLETA CB162 STD PP DPBO07 - FT120 - 5189941",
            "543": "ROSCA P2000 24 410 LISA PRETO DPB061 - 5188322",
            "544": "CAPA KAJAK NATURAL NT1954 ESSENCIA - 8 CAVIDADES - P6300198A",
            "580": "ROSCA M300 GL18 ESTRIADO VIOLETA CB162 PP DPBO72",
            "581": "ROSCA M300 GL18 ESTRIADO ROSA CB163 PP DPBO72",
            "582": "ATUADOR M300 ROSA CB163 STD PP DPB007 - FT120",
            "642": "COMPONENTES TRY OUT",
            "679": "ATUADOR M300 ROSA CB133 STD PP DPB007 - 5181121",
            "845": "CONECTOR BRANCO 42 MS - 30002196",
            "846": "CONECTOR AZUL 65 MS - 30002195",
            "847": "CONECTOR LARANJA 100 MS - 30002197",
            "861": "ROSCA MKIV MD 24 410 LISA PRETO CB166 PP PD06007",
            "862": "ATUADOR MD STD PRETO IMP CB166 PE 01PD06003 (DIF. DISP.)",
            "865": "TURBINA 2 PARA FILTRO DE ÓLEO",
            "866": "TURBINA 1 PARA FILTRO DE ÓLEO",
            "892": "TAMPÃO PLÁSTICO P/ FILTRO DE OLEO NATURAL (SEM O'RING) - 485500038",
            "893": "PLUG 1/2\" 225 P/ F OLEO (SEM O'RING) - 475400188",
            "894": "CONJUNTO TAMPÃO (SEM O'RING) - 485500078",
            "895": "PLUG DO DRENO + VEDADOR (SEM O'RING) - 475400128",
            "904": "TAMPA-EM-28,20-PP-BLAC-SHNY---EM STD - 31147263",
            "905": "CLIP PLASTICO PP-RND DS10 K2/F3 DOURADO (MODIF) - 29029917",
            "921": "ATUADOR-EMII-PP--4,34-RED--SPRAY--ES38 29025968",
            "936": "ATUADOR-EMII-PP--4,34-RED-SHNY--SPRAY-A3 - 10605704",
            "937": "ATUADOR P2000 SATIN AZUL CB167 PP DPB039 - 5202563",
            "938": "PISTÃO P2000 ROD PRINC AZUL CB167 PP DPB044 - 5202564",
            "939": "ROSCA P2000 24 410 LISA AZUL CB167 PP DPB061 - FT120 - 5202562",
            "946": "ATUADOR MKIV STD PRETO 166 PP 01PD06002 (ATUADOR SPRAY)",
            "948": "ATUADOR-EMII-PP--4,34-BLUE--SPRAY--29025909",
            "951": "ATUADOR_CAP-KAJAK--PP-BLAC-MATT-- VP3 - 16 CAV 29025937",
            "967": "ROSCA M300 GL18 ESTRIADO ROSA CB168 PP DPB072",
            "968": "ATUADOR M300 ROSA CB168 STD PP DPB007",
            "982": "ATUADOR MKIV STD PRETO IMP. CB166 PP 01PD06002",
            "1003": "ROSCA MKIV MD 24 410 LISA OURO CB112 PP 13 PD06007 - 5203349",
            "1005": "ATUADOR-EMII-PP--4,34-YELL--SPRAY--DS22 - 29025934",
            "1063": "ROSCA M300 GL18 ESTRIADO NATURAL PP DPB072 - 5204910",
            "1100": "TAMPA PLÁSTICA 5831 - 285058311",
            "1101": "SUPORTE DO COPO - 4 CAVIDADES - NYLON - 283600909",
            "1135": "FIXAÇÃO-GS-28/410CUST--THREAD-HDPE-WINE 31147706",
            "1145": "TAMPA PLÁSTICA 4 CAVIDADES - 285058959",
            "1146": "SUPORTE PLÁSTICO SÉRIE 600 ESCAL (COM ABA) - 283600949",
            "1177": "ATUADOR-EMII-PP--4,34-BLUE--SPRAY--293C - 31160473",
            "1179": "ATUADOR-EMII-PP--4,34-BLUE--SPRAY-LMPP - 31161295",
            "1187": "PISTÃO P2000 ROD PRINC NATURAL PP SEM ON/OFF DPB044 - 5207785",
            "1514": "FIXAÇÃO-GS-28/410CUST--THREAD-HDPE-PINK - 31162234",
            "1490": "ATUADOR M300 VERDE CB180 (UVA VERDE) - 5208567",
            "1493": "ATUADOR M300 ROSA CB177 (FRUTAS VERMELHAS) - 5208564",
            "1495": "ATUADOR M300 LILÁS CB181 (ALGODÃO) - 5208568",
            "1623": "TAMPA MKIV MD STD PRETA PP PD060 - 5208388",
            "1617": "ATUADOR MD150 STD LILÁS CB183 - 5208648 ( DIF. DISP)",
            "1618": "ROSCA MKIV MD 24 410 LISA LILÁS CB183 - 5208646",
            "1620": "ROSCA MKIV MD 20 410 LISA AMARELO CB184 - 5208980",
            "1622": "ATUADOR MD150 STD AMARELO CB184 01PD06003 - 5208981 (DIF. DISP.)",
            "1731": "ATUADOR -EMII-PP--4,34-GREY--SPRAY-- 31166627",
            "1771": "BLOCK ICE SKATE MSC BLUE 065MS",
            "1772": "BLOCK ICE SKATE MSC ORANGE 100MS",
            "1768": "BLOCK ICE SKATE MSC WHITE 042MS",
            "1769": "BLOCK ICE SKATE MSC RED 025MS",
            "1770": "BLOCK ICE SKATE MSC YELLOW 017MS",
            "1767": "BLOCK ICE SKATE MSC PINK 035MS",
            "1925": "ATUADOR-EMII-PP-GOLD---SPARY--DS24 - 29025972",
            "2155": "CAPA ALAV REG ALTURA A9 - 1154610X",
            "2172": "ALAVANCA HANDLE MONTADA - (ESQ) 1280075X / 1280071X (DIR)",
            "2171": "ALAVANCA HANDLE MONTADA",
            "2181": "ATUADOR-EMII-PP--4,34-SILV---SPRAY---31147632",
            "2232": "CLIPE-K-GS-PP-RED---17,45--- 31178644",
            "2278": "ATUADOR_CAP-KAJAK--PP-BLUE-MATT-433C---E---(16 CAVS) 31182968",
            "2290": "TAMPA-EM-28,20-PP-RED--SHNY---EM STD - 31178555",
            "2291": "ATUADOR-EMII-PP--4,34-RED---SPRAY--- 31178556",
            "2329": "FIXAÇÃO-GSA-28/410CUST---THREAD-HDPE-RED - 31178148",
            "2231": "ATUADOR-EMII-PP--4,34-YELL---SPRAY--DS27 - 29025969",
            "2463": "ATUADOR_CAP-KAJAK--PP-WHIT-MATT---ESSEN - 29029501 (REMESSA)",
            "2478": "FIXAÇÃO-GSA-28/410CUST---THREAD-HDPE-ILL - 31187111",
            "2448": "FIXAÇÃO-GSA-28/410CUST---THREAD-HDPE-ORA - 31186155",
            "2563": "ROSCA BAIXA P2000 28 400 ESTRIADA NATURAL DP8064 - DP179A - 5225858",
            "2505": "FIXAÇÃO-GSA-28/410CUST---THREAD-HDPE-ORA - 31188963",
            "1601": "CLIPE-K-GS-PP-SILV---MB21--17,45--- (29029915)",
            "2453": "ATUADOR_CAP-KAJAK--PP-BLAC-MATT---ESSEN - 29029497",
            "2460": "ATUADOR_APK-AJAK--PP-BLUE-MATT-433C---E---31182968",
            "2564": "ATUADOR MD150 STD ROSA METALIZADO CB203 01PD060 - 5217148 (DIF. DISP.)",
            "2457": "ATUADOR_APK-AJAK--PP-RED-MATT- ES37--ES - 29029494",
            "2574": "ATUADOR-EMII-PP--4,34-BLUE---SPRAY---31193634",
            "2458": "ATUADOR_APK-AJAK--PP-NATU-MATT- NT1954 - 29029912",
            "2561": "ATUADOR-EMII-PP--4,34-GOLD---SPRAY - 31194945",
            "2454": "ATUADOR_APK-AJAK--PP-ORAN-MATT---ESSEN - 29029488",
            "2452": "ATUADOR_APK-AJAK--PP-BLUE-MATT---ESSEN - 29029484",
            "2455": "ATUADOR_APK-AJAK--PP-GREE-MATT---ESSEN - 29029495",
            "2456": "ATUADOR_APK-AJAK--PP-WHIT-MATT---ESSEN - 29029501",
            "2666": "ATUADOR-EMII-PP--4,34-PINK---SPRAY---2405 - 31199260",
            "2704": "ROSCA P2000 24 410 LISA BR 767 PP DP8601 - 5229030",
            "2707": "ATUADOR-EMII-PP--4,34-WHIT---SPRAY---CS03 - 29025974",
            "2701": "ATUADOR-EMII-PP--4,34-BLUE---SPRAY---KS17 - 29025931",
            "2710": "ATUADOR-EMII-PP--4,34-GOLD---SPRAY--PPG1 - 31201727",
            "2899": "ATUADOR P2000 SATIN ROXO CB231 PP DP8037 - 5233798",
            "2897": "ANEL TRAVA P2000 STD ROXO TEXT CB231 PP DP8038 - 5233797",
            "2898": "ROSCA ALTA P2000 28 410 TEXT ROXO CB231 PP - 5233796 (FOSCO)",
            "2895": "ATUADOR MKIV STD OURO CB233 PP 01PD06002 - 5234308 (ATUADOR SPRAY)",
            "2957": "ATUADOR-EMII-PP--4,34-ORAN---SPRAY---PR - 31213312",
            "2963": "CORPO CANETA NOVA ZERO STICK CLEAR - CRISTAL NATURAL - 99.47.016",
            "2970": "CORPO CANETA NOVA ZERO STICK SOLID COLOR - VERDE - 99.47.012",
            "3021": "TAMPA SLIM CINZA GRAFITE PEROLIZADO II - 99.43.071",
            "3008": "CORPO CANETA OFFICE BALCÃO PRETO FUMÉ CLARO 16 CAVS - 99.16.013",
            "3020": "CORPO SLIM CINZA GRAFITE PEROLIZADO II - 99.44.150",
            "2294": "SUPORTE DO COPO NOVO - 6 CAVIDADES - TECHNYL - 283601079",
            "2069": "TAMPA PLÁSTICA 5923 - 285059119 - LANKESS",
            "2206": "SUPORTE DO COPO NOVO - 6 CAVIDADES - NYLON - 283601079",
            "2998": "ROSCA ALTA P2000 28 410 FOSCA AZUL CB236 PP - 5234579",
            "3031": "RODA DO LANÇADOR AZUL (SEM FURO TRAVA)",
            "3000": "ATUADOR P2000 SATIN AZUL CB236 PP DPB037 - 5234577",
            "3002": "ATUADOR_CAP-KAJAK--PP-ORAN-MATT- 7416C - 31216799",
            "3034": "ATUADOR MKIV STD AZUL CB241 PP Q1PD06002 - 5243024 (ATUADOR SPRAY)",
            "3035": "ATUADOR MKIV STD VERMELHO CB242 PP Q1PD06002 - 5243026 (ATUADOR SPRAY)",
            "3050": "ATUADOR MKIV STD PRETO CB243 PP Q1PD06002 - 5243037 (ATUADOR SPRAY)",
            "3071": "TAMPA SLIM BLENDER - TRANSPARENTE II - 99.43.059",
            "3079": "TAMPA SLIM AZUL SAFIRA II - 99.43.038",
            "3081": "TAMPA SLIM AZUL SKY BLUE PASTEL II - 99.43.055",
            "3091": "TAMPA SLIM LARANJA PESSEGO PASTEL II - 99.43.057",
            "3115": "TAMPA SLIM VERDE OLIVA (FOSCO) II - 99.43.068",
            "3093": "TAMPA SLIM LARANJA PUMPKIN II - 99.43.041",
            "3124": "CORPO SLIM PRETO ONIX II - 99.44.126",
            "3087": "TAMPA SLIM CINZA MEDIO II - 99.43.062",
            "3089": "TAMPA SLIM CINZA PASTEL II - 99.43.063",
            "3085": "TAMPA SLIM CINZA CLARO II - 99.43.061",
            "3054": "ATUADOR P2000 SATIN CHUMBO CB194 PP - 5211206",
            "3052": "ROSCA P2000 24 410 LISA CHUMBO CB194 PP DPB601 - 5211080",
            "3075": "TAMPA SLIM AMARELO VANILA (PASTEL) II - 99.43.054",
            "3003": "ATUADOR_CAP-KAJAK--PP-GREE-MATT- 7470C-- 31216879",
            "891": "TAMPA PLÁSTICO P/ FILTRO DE OLEO AMARELO (SEM O'RING) - 485500068",
            "3153": "FIXAÇÃO-GSA-28/410CUST--THREAD-HDPE-RED - 31212750",
            "3097": "TAMPA SLIM MARROM CAOUCCINO II - 99.43.047",
            "3073": "TAMPA SLIM AMARELO CHEGUEI (NEON) II - 99.43.051",
            "3095": "TAMPA SLIM LARANJA VULCAO (NEON) II - 99.43.065",
            "3101": "TAMPA SLIM ROSA PINK (MEDIO) II - 99.43.044",
            "3146": "CORPO SLIM PEROLADO II - 99.44.153",
            "3121": "TAMPA SLIM PRETO ONIX II - 99.43.037",
            "1912": "SUPORTE PLÁSTICO - 283601089",
            "3202": "ATUADOR MKIV STD BRONZE CB245 PP Q1PD06002 - 5243743",
            "3204": "TAMPA MKIV MD BRONZE CB245 PP PD060 - 5243745",
            "3268": "CORPO SLIM II BRANCO RADIANTE - 99.44.125",
            "3267": "TAMPA SLIM II BLACK SCORPIO GLITTER (PRETO) - 99.43.081",
            "3256": "TAMPA SLIM II PURPLE PISCES GLITTER (ROXO) - 99.43.075",
            "3264": "TAMPA SLIM II VIOLET VIRGO GLITTER (LILAS) - 99.43.074",
            "3263": "TAMPA SLIM II ORANGE CANCER GLITTER (LARANJA) - 99.43.084",
            "3292": "FIXAÇÃO-GSA-28/410CUST--THREAD-HDPE-GRE - 31227541",
            "3381": "ATUADOR MKIV STD NATURAL PP CB214 Q1PD06002 - 5225211 (C/ ADITIVO)",
            "3446": "CONECTOR MODELO T AZUL",
            "3444": "CONECTOR MODELO L AMARELO",
            "3466": "CORPO SLIM II LARANJA VULCAO - 99.44.130",
            "3147": "TAMPA SLIM II ROXO THANOS (NEON) - 99.43.043",
            "3443": "CONECTOR MODELO R VERDE",
            "3465": "CORPO SLIM II MAGIC PINK (NEON) - 99.44.133",
            "3099": "TAMPA SLIM II ROSA MAGIC PINK - 99.43.064",
            "3445": "CONECTOR MODELO X MARROM",
            "3457": "TAMPA PLÁSTICA 5923 - 285059119 - DURETHAN",
            "3474": "CORPO SLIM II PRATA - 99.44.135",
            "3150": "TAMPA SLIM II AZUL ELETRIC BLUE - 99.43.050",
            "3442": "CONECTOR MODELO V CINZA",
            "3107": "TAMPA SLIM II ROXO LAVANDA (PASTEL) - 99.43.058",
            "3113": "TAMPA SLIM II VERDE MENTA (PASTEL) - 99.43.053",
            "3103": "TAMPA SLIM II ROSA QUARTZ - 99.43.056",
            "3468": "CORPO SLIM II AMARELO CHEGUEI - 99.44.138",
            "3460": "CORPO SLIM II ROSA QUARTZ - 99.44.140",
            "3461": "CORPO SLIM II AZUL SKY BLUE - 99.44.141",
            "3117": "TAMPA SLIM II VERMELHO ESCARLETE - 99.43.039",
            "3464": "CORPO SLIM II LARANJA PESSEGO - 99.44.146",
            "3463": "CORPO SLIM II VERDE MENTA - 99.44.142",
            "3504": "TAMPA INFERIOR PARA FILTRO - 285058439",
            "3503": "TAMPA SUPERIOR PARA FILTRO - 285058449",
            "3459": "CORPO SLIM II ROXO LAVANDA - 99.45.145",
            "3462": "CORPO SLIM II AMARELO VANILLA - 99.44.144",
            "3529": "CORPO SLIM II ROXO THANOS - 99.44.132",
            "3530": "CORPO SLIM II AZUL ELETRIC BLUE - 99.44.137",
            "3510": "ATUADOR-EMII-PP--4,34-BLUE---SPRAY---MO - 31235033",
            "3526": "ATUADOR P2000 SATIN ROSA CB256 PP DPB037 - 5254022",
            "3545": "ATUADOR MKIV STD ROSA CB256 PP Q1PD06002 - 5254331",
            "3524": "ROSCA ALTA P2000 28 410 TEXT ROSA CB256 PP DPB063 - 5254021",
            "3523": "ANEL TRAVA P2000 STD ROSA TEXT CB256 PP DPB038 - 5254020",
            "2969": "CORPO CANETA NOVA ZERO STICK BRANCO FECHADO - 99.47.011",
            "3532": "ROSCA ALTA P2000 28 410 TEXT OURO CB257 PP DPB063 - 5254357",
            "3531": "ANEL TRAVA P2000 STD OURO TEXT CB257 PP DPB038 - 5254356",
            "3533": "ATUADOR P2000 SATIN OURO CB257 PP DPB037 - 5254358",
            "3525": "ROSCA P2000 24 410 LISA ROSA CB256 PP DPB601 - 5254018",
            "3287": "CORPO CANETA NOVA ZERO STICK PRETO FECHADO - 99.47.010",
            "3544": "CORPO CANETA NOVA ZERO STICK COLOR FUME - 99.47.022",
            "3149": "TAMPA SLIM II CINZA GRAFITE (ESCURO) - 99.43.045",
            "3083": "TAMPA SLIM II BRANCO - 99.43.048",
            "3677": "ANEL TRAVA P2000 STD VERMELHO TEXT CB260 PP DPB038 - 1.01.03.005.760",
            "3676": "ROSCA ALTA P2000 28 410 TEXT VERMELH CB260 PP DPB063 - 1.01.03.005.759",
            "3152": "TAMPA SLIM II AMARELO GIRASCOL (FOSCO) - 99.43.042",
            "3109": "TAMPA SLIM II VERDE AMAZONAS (ESCURO) - 99.43.040",
            "3682": "CORPO CANETA OFFICE BALCAO AZUL 16 CAVS - 99.16.001",
            "3119": "TAMPA SLIM II VERMELHO RED CANDY - 99.43.066",
            "3719": "CORPO CANETA NOVA ZERO STICK COLOR - AZUL - 99.47.017",
            "3718": "CORPO CANETA NOVA ZERO STICK SOLID COLOR - AZUL MARINHO - 99.47.019",
            "3662": "FIXAÇÃO-GS-28/410CUST-28---THREAD-HDPE-NATURAL - 31151140",
            "3745": "RETENTOR MKIV MD M300 STD NAT POM DF002 - 24 CAVS - 1.01.01.005.042",
            "3443": "CONECTOR MODELO R VERDE MOLDE 2 - 120°",
            "3447": "CONECTOR MODELO I VERMELHO MOLDE 3 - RETO (180°)",
            "3442": "CONECTOR MODELO V CINZA MOLDE 1 - 30°",
            "3445": "CONECTOR MODELO X MARROM MOLDE 1 - CRUZ (360°)",
            "3570": "ATUADOR-EMII-PP--4,34-GOLD---SPRAY - 31221881",
            "3746": "RETENTOR M300 STD NAT POM DF002 - 64 CAVIDADES - 1.01.01.005.025",
            "3725": "TAMPA PLASTICA SEM FURO (NOVA VERSAO) - 285050749",
            "3586": "ATUADOR-EMII-PP--4,34-ORAN---SPRAY---MO - 31238801",
            "3810": "CORPO SLIM II PRETO ONIX C/ GLITTER - 99.44.151",
            "3467": "CORPO SLIM II VERDE VER DE LONGE - 99.44.139",
            "3807": "ROSCA ALTA P2000 28 410 TEXT BRANCO CB263 PP DPB063 - 1.01.03.005.779",
            "3806": "ATUADOR P2000 SATIN BRANCO CB263 PP DPB037 - 1.01.03.005.781",
            "3805": "ANEL TRAVA P2000 STD BRANCO CB 263 TEXT PP DPB038 - 1.01.03.005.780",
            "3111": "TAMPA SLIM II VERDE VER DE LONGE (NEON) - 99.43.052",
            "3148": "TAMPA SLIM II MARROM CHOCOLATE (NEON) - 99.43.070",
            "3827": "ANEL TRAVA P2000 STD AZUL TEXT CB266 PP DPB038 - 1.01.03.005.790",
            "3825": "ROSCA P2000 28 410 TEXT AZUL CB266 PP DPB063 - 1.01.03.005.788",
            "3826": "ATUADOR P2000 SATIN AZUL CB266 PP DPB037 - 1.01.03.005.789",
            "3870": "ATUADOR-EMII-PP--4,34---SPRAY-BLACK - 31262039",
            "3891": "FIXAÇÃO-GS-28/410CUST---THREAD-HDPE-PINK - 31247523",
            "3159": "FIXACAO-GSA-28/410CUST---THREAD-HDPE-III - 31205434",
            "124": "ATUADOR MD STD NATURAL PE 01PD06003 - 1.01.03.005.820",
            "3858": "POTE DE SORVETE BRANCO - CP191",
            "3859": "TAMPA BRANCA DO POTE DE SORVETE BRANCO - CP191",
            "3956": "ATUADOR-EMII-PP--4,34-LLA---SPRAY---CL - 31265594",
            "3983": "TAMPA PLASTICA 5831 - 285058311",
            "3817": "TAMPA SUPERIOR PARA FILTRO - 285058449",
            "3818": "TAMPA INFERIOR PARA FILTRO - 285058439",
            "3924": "FIXAÇÃO-GS-28/410CUST---THREAD-HDPE-ILLA - 31266385",
            "4010": "SUPORTE PLASTICO SERIE 600 ESCAL (COM ABA) - 283600949",
            "4091": "CLIP-Q--PP-NATU-XX04 - 29029920",
            "4047": "TAMPA PLASTICA 4 CAVIDADES - 285058959",
            "4048": "TAMPA PLASTICA SEM FURO - 285058389",
            "4017": "PISTAO PARA FILTRO DE OLEO - 275410349",
            "4046": "BOCAL PARA FILTRO DE OLEO - 207803839",
            "4007": "FACE EXTERNA BRANCA CSI - PECA 2",
            "4008": "TAMPA BRANCO CSI - PECA 3",
            "4006": "FACE INTERNA BRANCA CSI - PECA 1",
            "4172": "J-HOOK LONG BLUE (CLIP AZUL) - 1020710",
            "4199": "TAMPA AMARELO DO POTE DE SORVETE - CP191",
            "4198": "TAMPA VERMELHO DO POTE DE SORVETE - CP191",
            "4157": "TAMPA PLASTICA 4 CAVIDADES - 285058959",
            "4161": "ATUADOR-POEMA-PP--5,75-NATU---LOT-XX04 - 31194670",
            "4134": "FIXAÇÃO-GS-24/410--2N-THREA-PP-BLAC--MA - (LISO COM DEGRAU) - 29026043",
            "4128": "FIXAÇÃO-GS-24/410--2N-THREA-PP-RED--485 - (LISO COM DEGRAU) - 31192751",
            "4219": "FIXAÇÃO-GS-24/410--2N-THREAD-PP-GOLD--- (LISO COM DEGRAU) - 31219743",
            "4127": "FIXAÇÃO-GS-24/410--2N-THREAD-PP-WHIT--20 - (LISO COM DEGRAU) - 29025477",
            "4246": "FIXAÇÃO-GS-24/410--2N-THREAD-PP-YELL--DS (LISO COM DEGRAU) - 29032402",
            "4141": "FIXAÇÃO-GS-24/410--2N-THREA-PP-VIOL--- (LISO COM DEGRAU) - 31242869",
            "4267": "FIXAÇÃO-GS-28/410CUST---THREAD-HDPE-ILLA - 31285150",
            "4166": "FIXAÇÃO-GS-24/410--2N-THREAD-PP-NATU--XX (LISO COM DEGRAU) - 29029921",
            "4253": "ATUADOR-POEMA-PP--5,75-WINE---LOT-ES44-- 31227564",
            "4268": "FIXAÇÃO-GS-28/410CUST-28--THREAD-HDPE-NATURAL - 31285216",
            "4269": "FIXACAO-GSA-28/410CUST---THREAD-HDPE-III - 31285116",
            "233": "TRAVA DO CARRETEL",
            "4196": "FIXAÇÃO-GS-24/410--2N-THREA-PP-BEIG--- (LISO COM DEGRAU) - 31246287",
            "4270": "FIXAÇÃO-GS-28/410CUST---THREAD-HDPE-WINE - 31226472",
            "4275": "FIXACAO-GSA-28/410CUST---THREAD-HDPE-RED - 31285119",
            "4301": "ILUMINADOR CRYSTAL LUX - MP00026",
            "4300": "EMPUNHADURA 30X95 - MP00208",
            "4321": "FIXAÇÃO-GS-24/410-2N-THREAD-PP-BLUE--31-31284786",
            "4410": "ATUADOR MKIV STD BRANCO CB263 PP Q1PD06002 - 1.01.03.005.848",
            "4371": "FIXAÇÃO-GS-24/410-2N-THREAD-PP-GREE---31263788",
            "4366": "FIXAÇÃO-GS-24/410-2N-THREAD-PP-PINK--- (LISO COM DEGRAU) - 31255322",
            "4322": "FIXAÇÃO-GS-24/410-2N-THREAD-PP-GREE--22-31284788 (LISO COM DEGRAU)",
            "4003": "PAINEL SWITCHES LIGHT - S1700150",
            "4274": "FIXACAO-GSA-28/410CUST--THREAD-HDPE-ORA - 31285244",
            "4409": "TAMPA-EM-28,20-PP-BLAC-BLACK 5C-SHNY--- 31262040",
            "4408": "TAMPA-EM-28,20-PP-ORAN--SHNY--- 31213174",
            "4425": "FIXAÇÃO-GS-28/410CUST--THREAD-HDPE-WINE - 31291815",
            "4442": "TAMPA-EM-28,02-PP-BLUE--SHNY---MOCHILÃ - 31235004",
            "4143": "ATUADOR-SENTIDOS-PP--5,75-WINE---LOT-ES4 - 29029209",
            "4497": "TAMPA-EM-28,02-PP-GOLD--SHNY- 31221895",
            "3939": "SHELL PLASTIC EXEL™ YELLOW 17MS (CONECT. AMARELO EXP.) - 1002040",
            "4160": "ATUADOR-SENTIDOS-PP--5,75-NATU---LOT-XXO - 31149108",
            "4485": "TAMPA MKIV MD STD BRANCA CB263 PP PD060 - 1.01.03.005.849",
            "4323": "FIXAÇÃO-GS-24/410-2N-THREAD-PP-LARANJA--15-31284542 (LISO COM DEGRAU)",
            "4514": "FIXAÇÃO-GS-24/410-3N-THREAD-PP-NATU-RRN (ESTR COM DEGRAU) - 10303840",
            "4512": "TAMPA-EM-28,20-PP-LLLA--SHNY--- NIX TOD - 31265596",
            "4505": "TAMPA MKIV MD STD FUME CB280 PP PD060 - 1.01.03.005.853",
            "4447": "ROSCA MKIV MD 24 410 LISA BRANCA CB263 PP PD06007 - 1.01.03.005.850",
            "4498": "ATUADOR-SENTIDOS-PP--5,85-ORAN---LOT--- 31188965",
            "4272": "FIXAÇÃO-GS-28/410CUST--THREAD-HDPE-PINK - 31285219",
            "4460": "ATUADOR-EMII-PP---4,34-PINK---SPRAY---GL - 31295342",
            "4508": "FIXAÇÃO-GS-28/410CUST---THREAD-HDPE-GREE - 31295307",
            "4536": "ATUADOR MKIV STD OURO CB281 PP Q1PD06002 - 1.01.03.005.855",
            "4509": "ATUADOR-SENTIDOS-PP--5,75-PINK---LOT--- 31247527",
            "4538": "ROSCA MKIV MD 20 410 LISA OURO CB281 PP - 1.01.03.005.856",
            "4557": "ANEL TRAVA P2000 STD PP TEXT ROXO CB270 DPB038 - 1.01.03.005.823",
            "4050": "TAMPA PLASTICA SEM FURO (NOVA VERSAO) - 285050749",
            "4555": "ROSCA ALTA P2000 28 410 TEXT ROXO CB270 DPB063 - 1.01.03.005.822",
            "4558": "ROSCA P2000 24 410 LISA BRANCA CB263 PP DPB061 - 1.01.03.005.826",
            "4324": "FIXAÇÃO-GS-24/410-2N-THREAD-PP-YELL--13-31284632 (LISO COM DEGRAU)",
            "4596": "ROSCA MKIV MD 22 415 ESTRIADA PRETO 017 PP Q9PD06007 - 1.01.01.005.128",
            "4501": "ROSCA MKIV MD 24 410 LISA VERMELLA CB242 PP - 1.01.01.005.509",
            "4608": "ATUADOR MD STD ROSA CB282 Q1PD06003 - 1.01.03.005.858",
            "4609": "ROSCA MKIV MD 24 410 LISA ROSA CB282 PP - 1.01.03.005.859",
            "4504": "ROSCA MKIV MD 24 410 LISA PRETO 017 PP - 1.01.01.005.284",
            "4502": "ROSCA MKIV MD 24 410 LISA BR 767 PP - 1.01.01.005.242",
            "4448": "ROSCA MKIV MD 20 410 ESTRIADA PRETO 17 PP Q5PD06007 - 1.01.01.005.399",
            "3511": "COMPONENTES TRY OUT - SILGAN",
            "4667": "ATUADOR MKIV STD BEGE CB286 PP Q1PD06002 - 1.01.03.005.863",
            "4597": "ROSCA MKIV MD 20 410 LISA OURO PEROLADO CB204 PP - 1.01.01.005.400",
            "4666": "ATUADOR MD150 STD BEGE CB286 Q1PD06003 - 1.01.03.005.862",
            "4271": "FIXACAO-GSA-28/410CUST---THREAD-HDPE-RED - 31285212",
            "4668": "ROSCA MKIV MD 24 410 LISA BEGE CB286 PP - 1.01.03.005.864",
            "4645": "ROSCA MKIV MD 20 410 LISA BRONZE CB240 PP - 1.01.01.005.506",
            "4749": "FIXAÇÃO-GS-24/410-2N-THREAD-PP-PINK---(LISO COM DEGRAU) 31233264",
            "4784": "ANEL TRAVA P2000 STD PP TEXT AZUL CB288 PP DPB038 - 1.01.03.005.869",
            "4783": "ROSCA ALTA P2000 28 410 TEXT AZUL CB288 DPB063 - 1.01.03.005.868",
            "4785": "ATUADOR P2000 SATIN AZUL CB288 PP DPB037 - 1.01.03.005.870",
            "4693": "ATUADOR-EMII-PP--4,34-BLUE--SPRAY---CL - 31302654",
            "574": "MANOPLA MACA (HANDLER) - LHC 390-20351",
            "4769": "FIXADOR FUNDO FECHADO 6M SEM FURO - KG 4A",
            "4824": "ATUADOR MKIV STD AMARELO PEROLA CB289 PP Q1PD06002 - 1.01.03.005.879",
            "4823": "ROSCA MKIV MD 24 410 LISA AMERELO PEROLA CB289 PP - 1.01.03.005.878",
            "4794": "ROSCA ALTA P2000 28 410 TEXT ROSA CB271 DPB063 - 1.01.03.005.875",
            "4795": "ANEL TRAVA P2000 STD PP TEXT ROSA CB271 PP DPB038 - 1.01.03.005.876",
            "4807": "ROSCA MKIV MD 20 410 LISA NAT PP - 1.01.01.005.429",
            "2999": "ANEL TRAVA P2000 STD AZUL CB236 PP TEXT DPB038 - 1.01.01.005.496",
            "4500": "ROSCA MKIV MD 20 410 ESTR BR ANIL 2902 Q5PD06007 - 1.01.01.005.126",
            "4907": "DISTRIBUIDOR DE CREPINA INFERIOR - 40070280",
            "4906": "CREPINA SIMPLES ABERTA F-450 E F-550 - 40070281",
            "4899": "CAIXA DE CONTROLE DO GERADOR DE CLORO RESIDENCIAL GS - 40070236",
            "4154": "TAMPA PLASTICA SEM FURO (NOVA VERSAO) - 285050749",
            "4909": "DISTRIBUIDOR DE CREPINA SUPERIOR - 40070279",
            "4152": "BOCAL PARA FILTRO DE OLEO - 207803839",
            "4153": "PISTAO PARA FILTRO DE OLEO - 275410349",
            "4914": "CORPO DO GERADOR DE CLORO RESIDENCIAL GS - 40070234",
            "5025": "TAMPA-EM-28,20-PP-PINK--SHNY---TODODIA - 31313534",
            "4915": "CREPINA SIMPLES ABERTA F-650 E F-750 - 40070282",
            "4688": "ATUADOR-SENTIDOS-PP--5,85-YELL--LOT--- 31300894",
            "5050": "TAMPA CASSETE - 510080625PLP",
            "5048": "BASE CASSETE MONTADA - 510080655PLP",
            "5083": "ATUADOR-SENTIDOS-PP--5,75-LILA--LOT--- 31266387",
            "4687": "FIXAÇÃO-GS-28/410CUST---THREAD-HDPE-YELL - 31300875",
            "3943": "SHELL PLASTIC EXEL™ RED 25MS (CONECT. VERMELHO EXP.) - 1002047",
            "5081": "ATUADOR P2000 SATIN VERDE CB295 PP DPB037 - 1.01.03.005.896",
            "5194": "FIXAÇÃO-GS-28/410CUST---THREAD-HDPE-PINK - 31328162",
            "4913": "UNIAO ROSCADA GERADOR DE CLORO RESIDENCIAL GS - 40070238",
            "5079": "ROSCA ALTA P2000 28 410 TEXT VERDE CB295 DPB063 - 1.01.03.005.899",
            "5034": "CONECTOR,PLAST,MS-CONNECTOR ROJO - (CONECT. VERMELHO EXP.) - 10100169",
            "5035": "CONECTOR,PLAST,MS-CONNECTOR,AMARILLO - (CONECT. AMAR. EXP.) - 10100166",
            "5302": "ATUADOR-K2-PP---NATU---RRNA00004-- 11001314",
            "5026": "ATUADOR-EMII-PP--4,34-PINK---SPRAY---TO - 31313535",
            "4193": "TAMPA LILAS DO POTE DE SORVETE - CP191",
            "4195": "TAMPA AZUL DO POTE DE SORVETE - CP191",
            "5416": "ACTU-K2-PP---BLUE---P223 - 29001711",
            "4900": "TAMPA CAIXA DE CONTROLE DO GERADOR DE CLORO RESIDENCIAL GS - 40070237",
            "5382": "ATUADOR-EMII-PP--4,34-GOLD---SPRAY-13017 - 31327903",
            "4690": "TAMPA-EM-28,20-PP-ORAN--SHNY---EUROMIS -- 31300904",
            "5448": "BASE PARA TOMADAS 20A MILUZ - 51B24718",
            "5482": "PECA 1 PRETO POLICARBONATO - P1P2024",
            "5484": "PECA 1 CINZA NYLON - P1N2024",
            "4732": "JUNCAO SEM FURO - KG 2",
            "4691": "ATUADOR-EMII-PP--4,34-ORAN---SPRAY---EU - 31300906",
            "5537": "ATUADOR-A03LV1-PP---BLAC---MA00 - 10302157",
            "5328": "ATUADOR-A46V1-PP---NATU---RRNA00003--10302176",
            "4808": "SUPORTE DO COPO 4 CAVIDADES - 283600249",
            "4194": "TAMPA LARANJA DO POTE DE SORVETE - CP191",
            "5339": "FIXAÇÃO-GS-28/410CUST---THREAD-HDPE-ORAN - 31322938",
            "5710": "ATUADOR-SENTIDOS-PP--5,75-BROW---LOT---31329776",
            "5645": "ROSCA ALTA P2000 28 410 TEXT AZUL C8300 PP DP8063 - 1.01.03.005.947",
            "5741": "ATUADOR-K2-PP---BLAC---RBK000001---31025989",
            "5728": "FIXAÇÃO-GS-28/410CUST---THREAD-HDPE-PURP - 31336756",
            "5568": "TAMPA PARA TUBO EXTERNO - AST117 - BL310062",
            "5569": "TUBO EXTERNO - AST121 - BL310066",
            "5313": "ATUADOR-A03LV1-PP---NATU---RRNA00003--10302173",
            "5684": "ATUADOR-A03LV1-PP---BLUE-SHNY---329 - 31197642",
            "5855": "ROSCA MKIV MD 22 415 ESTRADA OURO CB112 PP 09PD06007 -1.01.01.005.039",
            "5708": "TAMPA-EM-28,20-PP-PURP--SHNY--- 31336631",
            "5332": "ACTU-A03LV1-PP---GREY-SHNY---P228 - 29002515",
            "5846": "FIXAÇÃO-GS-28/410CUST---THREAD-HDPE-PURP 31346237",
            "5870": "FLANGE PARA CARRETEL PLÁSTICO",
            "5860": "ATUADOR-EMII-PP--4,34-BLUE---SPRAY---KA - 31349610",
            "5859": "ATUADOR-EMII-PP--4,34-ORAN---SPRAY---KA - 31349501",
            "5958": "FLANGE PARA CARRETEL PLÁSTICO REEL IN THE BOX 3000093 - 112",
            "5937": "ATUADOR-EMII-PP--4,34-GREE---SPRAY---HE - 31347832",
            "5863": "TAMPA-EM-28,20-PP-BLUE--SHNY---KAIAK M - 31349609",
            "5879": "ATUADOR-EMII-PP--4,34-GREE---SPRAY---HE - 31347832",
            "5858": "ATUADOR-EMII-PP--4,34-RED---SPRAY--36423 - 31349486",
            "5974": "FIXAÇÃO-GS-28/410CUST-MARROM-THREAD-HDPE - 31349252",
            "5862": "TAMPA-EM-28,20-PP-ORAN--SHNY---KAIAK F - 31349490",
            "5861": "TAMPA-EM-28,20-PP-RED--SHNY---TODODIA - 31349485",
            "5290": "SUPORTE FLIPTOP BRANCA - AST206",
            "4150": "SUPORTE PLASTICO SERIE 600 ESCAL (COM ABA) - 283600949",
            "5999": "ATUADOR-EMII-PP--4,34-PURP---SPRAY--SD 2 - 31354753",
            "4766": "FIXADOR FUNDO FECHADO 3M SEM FURO - KG 1A",
            "4764": "CORREDICA FUNDO VAZADO 3M SEM FURO - KG 1B",
            "4647": "BASE TRIANGULAR - KG 3",
            "5709": "ATUADOR-EMII-PP--4,34-PURP---SPRAY--- 31336632",
            "5880": "TAMPA-EM-28,20-PP-GREE--SHNY---HERBAL - 31347833",
            "6001": "TAMPA-EM-28,20-PP-PURP--SHNY--- 31354752",
            "5477": "CONJ DISP DE SEGURANÇA BRA/ITA 10/20A - BR59 - HRB25067",
            "5729": "ATUADOR-EMII-PP--4,34-GOLD---SPRAY - 31308323",
            "6083": "ATUADOR-SENTIDOS-PP--5,75-LILAS-LOT-31205436",
            "6005": "ATUADOR-EMII-PP--4,34-ORAN---SPRAY--2459 - 31355148",
            "6006": "TAMPA-EM-28,20-PP-ORAN--SHNY---PARIPUE - 31355147",
            "6152": "RETENTOR M300 STD NAT POM DF002 - 64 CAVIDADES - 1.01.01.005.025",
            "5960": "DISPOSITIVO P/ENCAIXE DE CARRETEL - 3400118"
        };
        
        const dateSelector = document.getElementById('date-selector');
        const cicloForm = document.getElementById('ciclo-form');
        const machineSelector = document.getElementById('machine-selector');
        const cicloFields = document.getElementById('ciclo-fields');
        const obsTextarea = document.getElementById('observacoes');
        const formMaterial = document.getElementById('form-material');
        const tabelaMaterialBody = document.getElementById('tabela-material-body');
        const tabelaCicloBody = document.getElementById('tabela-ciclo-body');
        const tabButtons = document.querySelectorAll('.tab-button');
        const pageSections = document.querySelectorAll('.page-section');
        const printBtn = document.getElementById('print-btn');
        const codProdutoInput = document.getElementById('cod-produto-input');
        const nomePecaInput = document.getElementById('nome-peca-input');
        const codProdutoMaterial = document.getElementById('cod-produto-material');
        const nomePecaMaterial = document.getElementById('nome-peca');

        const showLoading = (containerId, isLoading) => {
            const container = document.getElementById(containerId);
            if(container) {
                const overlay = container.querySelector('.loading-overlay');
                overlay.classList.toggle('hidden', !isLoading);
                overlay.classList.toggle('opacity-0', !isLoading);
            }
        };

        const showToast = (message, type = 'info') => {
            const colors = {
                info: 'bg-blue-500', 
                success: 'bg-[#16A34A]', 
                warning: 'bg-[#F59E0B]', 
                error: 'bg-[#DC2626]'
            };
            const icons = {
                info: 'info', 
                success: 'check-circle-2', 
                warning: 'alert-triangle', 
                error: 'alert-circle'
            };
            const toast = document.createElement('div');
            toast.className = `toast flex items-center gap-3 text-white p-4 rounded-lg shadow-lg`;
            toast.classList.add(colors[type]);
            toast.innerHTML = `<i data-lucide="${icons[type]}"></i><p>${message}</p>`;
            document.getElementById('toast-container').appendChild(toast);
            lucide.createIcons();
            setTimeout(() => toast.remove(), 5000);
        };

        const updateConnectionStatus = (text, color) => {
            document.getElementById('connection-status-text').textContent = text;
            const dot = document.getElementById('connection-status-dot');
            dot.className = `w-3 h-3 rounded-full ${color}`;
            dot.classList.remove('animate-pulse');
        };
        
        const updateMachineSelector = () => {
             const maquinas = [
                'H-01', 'H-02', 'H-03', 'H-04', 'H-05', 'H-06', 'H-07', 'H-08', 'H-09', 'H-10', 
                'H-11', 'H-12', 'H-13', 'H-14', 'H-15', 'H-16', 'H-17', 'H-18', 'H-19', 'H-20', 
                'H-26', 'H-27', 'H-28', 'H-29', 'H-30', 'H-31', 'H-32'
            ];
            const maquinasComDados = Object.keys(cicloData.maquinas || {}).filter(maq =>
                Object.values(cicloData.maquinas[maq]).some(val => val !== '')
            ).sort((a, b) => parseInt(a.split('-')[1]) - parseInt(b.split('-')[1]));

            const maquinasDisponiveis = maquinas.filter(maq => !maquinasComDados.includes(maq));
            
            const currentSelection = machineSelector.value;
            machineSelector.innerHTML = '<option value="">-- Escolha uma máquina --</option>';

            if (maquinasDisponiveis.length > 0) {
                const optgroupDisponiveis = document.createElement('optgroup');
                optgroupDisponiveis.label = 'Máquinas para Novo Apontamento';
                maquinasDisponiveis.forEach(maq => {
                    const option = document.createElement('option');
                    option.value = maq;
                    option.textContent = maq;
                    optgroupDisponiveis.appendChild(option);
                });
                machineSelector.appendChild(optgroupDisponiveis);
            }

            if (maquinasComDados.length > 0) {
                const optgroupComDados = document.createElement('optgroup');
                optgroupComDados.label = 'Editar Apontamento Existente';
                maquinasComDados.forEach(maq => {
                    const option = document.createElement('option');
                    option.value = maq;
                    option.textContent = maq;
                    optgroupComDados.appendChild(option);
                });
                machineSelector.appendChild(optgroupComDados);
            }
            machineSelector.value = currentSelection;
        };
        
        const renderCicloTable = () => {
            const maquinasComDados = Object.keys(cicloData.maquinas || {}).filter(maq => 
                Object.values(cicloData.maquinas[maq]).some(val => val !== '')
            ).sort((a, b) => {
                const numA = parseInt(a.split('-')[1] || 0);
                const numB = parseInt(b.split('-')[1] || 0);
                return numA - numB;
            });

            tabelaCicloBody.innerHTML = '';
            if (maquinasComDados.length === 0) {
                tabelaCicloBody.innerHTML = `<tr><td colspan="11" class="text-center p-4 text-[#6B7280]">Nenhum lançamento de ciclo para esta data.</td></tr>`;
                return;
            }

            maquinasComDados.forEach(maq => {
                const data = cicloData.maquinas[maq];
                const row = document.createElement('tr');
                row.className = 'hover:bg-[#F9FAFB]';
                row.innerHTML = `
                    <td class="px-4 py-3 text-sm font-medium text-[#1F2937]">${maq}</td>
                    <td class="px-4 py-3 text-sm text-[#374151]">${data.peca || '-'}</td>
                    <td class="px-4 py-3 text-sm text-[#374151] text-center">${data.op || '-'}</td>
                    <td class="px-4 py-3 text-sm text-[#374151] text-center">${data.qtd_total_op || '-'}</td>
                    <td class="px-4 py-3 text-sm text-[#374151] text-center">${data.qtd_real || '-'}</td>
                    <td class="px-4 py-3 text-sm text-[#374151] text-center font-bold">${data.fim || '-'}</td>
                    <td class="px-4 py-3 text-sm text-[#374151] text-center">${data.cav || '-'}</td>
                    <td class="px-4 py-3 text-sm text-[#374151] text-center">${data.ciclo || '-'}</td>
                    <td class="px-4 py-3 text-sm text-[#374151] text-center">${data.pm || '-'}</td>
                    <td class="px-4 py-3 text-sm text-[#374151]">${data.material || '-'}</td>
                    <td class="px-4 py-3 text-center no-print">
                        <button data-maq="${maq}" class="delete-ciclo-btn text-[#DC2626] hover:text-[#B91C1C] p-1">
                            <i data-lucide="x-circle" class="w-4 h-4"></i>
                        </button>
                    </td>
                `;
                tabelaCicloBody.appendChild(row);
            });
            lucide.createIcons();
        };
        
        const clearAndDisableCicloForm = () => {
            cicloForm.reset();
            cicloFields.disabled = true;
        };
        
        const populateCicloForm = (maq) => {
            const data = cicloData.maquinas[maq] || {};
            cicloFields.querySelector('[data-col="qtd_total_op"]').value = data.qtd_total_op || '';
            cicloFields.querySelector('[data-col="qtd_real"]').value = data.qtd_real || '';
            cicloFields.querySelector('[data-col="fim"]').value = data.fim || '';
            cicloFields.querySelector('[data-col="cod_produto"]').value = data.cod_produto || '';
            cicloFields.querySelector('[data-col="cav"]').value = data.cav || '';
            cicloFields.querySelector('[data-col="ciclo"]').value = data.ciclo || '';
            cicloFields.querySelector('[data-col="pm"]').value = data.pm || '';
            cicloFields.querySelector('[data-col="peca"]').value = data.peca || '';
            cicloFields.querySelector('[data-col="material"]').value = data.material || '';
            cicloFields.querySelector('[data-col="op"]').value = data.op || '';
            cicloFields.disabled = false;
        };

        const loadCicloData = async () => {
            if (!db) return;
            showLoading('ciclo-container', true);
            const docRef = doc(db, `artifacts/${appId}/public/data/ciclo_controles`, selectedDate);
            try {
                // Adiciona um timeout à requisição
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 segundos
                
                const docSnap = await getDoc(docRef, { signal: controller.signal });
                clearTimeout(timeoutId);

                cicloData = docSnap.exists() ? docSnap.data() : { maquinas: {}, observacoes: '' };
                obsTextarea.value = cicloData.observacoes || '';
                updateMachineSelector();
                renderCicloTable();
                clearAndDisableCicloForm();
            } catch (error) {
                console.error("Erro ao carregar dados de ciclo:", error);
                if (error.name === 'AbortError') {
                    showToast("Erro de conexão: A base de dados não respondeu. Verifique se o Firestore foi criado no seu projeto Firebase e se as regras de segurança estão corretas.", 'error');
                } else {
                    showToast("Erro ao carregar dados de ciclo.", 'error');
                }
            } finally {
                showLoading('ciclo-container', false);
            }
        };

        const deleteCicloEntry = async (maq) => {
            if (!db || !cicloData.maquinas || !cicloData.maquinas[maq]) return;
            
            delete cicloData.maquinas[maq];
            showLoading('ciclo-container', true);
            try {
                const docRef = doc(db, `artifacts/${appId}/public/data/ciclo_controles`, selectedDate);
                await setDoc(docRef, cicloData); 
                showToast(`Lançamento da ${maq} removido!`, 'info');
                updateMachineSelector();
                renderCicloTable();
                clearAndDisableCicloForm();
            } catch (error) {
                 console.error("Erro ao remover lançamento de ciclo:", error);
                showToast("Erro ao remover o lançamento.", 'error');
            } finally {
                showLoading('ciclo-container', false);
            }
        };
        
        const saveCicloData = async (e) => {
            e.preventDefault();
            const selectedMachine = machineSelector.value;
            if (!selectedMachine) {
                showToast("Selecione uma máquina para salvar os dados.", 'warning');
                return;
            }

            if (!db) return;
            showLoading('ciclo-container', true);

            const maquinaData = {
                qtd_total_op: cicloFields.querySelector('[data-col="qtd_total_op"]').value,
                qtd_real: cicloFields.querySelector('[data-col="qtd_real"]').value,
                fim: cicloFields.querySelector('[data-col="fim"]').value,
                cod_produto: cicloFields.querySelector('[data-col="cod_produto"]').value,
                cav: cicloFields.querySelector('[data-col="cav"]').value,
                ciclo: cicloFields.querySelector('[data-col="ciclo"]').value,
                pm: cicloFields.querySelector('[data-col="pm"]').value,
                peca: cicloFields.querySelector('[data-col="peca"]').value,
                material: cicloFields.querySelector('[data-col="material"]').value,
                op: cicloFields.querySelector('[data-col="op"]').value
            };
            
            cicloData.maquinas = cicloData.maquinas || {};
            cicloData.maquinas[selectedMachine] = maquinaData;
            cicloData.observacoes = obsTextarea.value;
            
            try {
                const docRef = doc(db, `artifacts/${appId}/public/data/ciclo_controles`, selectedDate);
                await setDoc(docRef, cicloData); 
                showToast(`Dados da ${selectedMachine} salvos!`, 'success');
                updateMachineSelector();
                renderCicloTable();
                populateCicloForm(selectedMachine); 

            } catch (error) {
                console.error("Erro ao salvar dados de ciclo:", error);
                showToast("Erro ao salvar os dados de ciclo.", 'error');
            } finally {
                showLoading('ciclo-container', false);
            }
        };

        const addMaterial = async (e) => {
            e.preventDefault();
            if (!db) return;
            const btn = e.target.querySelector('button[type="submit"]');
            btn.disabled = true;

            const materialData = {
                date: selectedDate,
                preparador: document.getElementById('preparador').value,
                maquina: document.getElementById('maquina-prep').value,
                op: document.getElementById('op-prep').value,
                nomePeca: document.getElementById('nome-peca').value,
                codProduto: document.getElementById('cod-produto-material').value,
                qtdMat: document.getElementById('qtd-mat').value,
                skResina: document.getElementById('sk-resina').value,
                loteResina: document.getElementById('lote-resina').value,
                skMaster: document.getElementById('sk-master').value,
                loteMaster: document.getElementById('lote-master').value,
                skAditivo: document.getElementById('sk-aditivo').value,
                loteAdit: document.getElementById('lote-adit').value,
                percentUsado: document.getElementById('percent-usado').value,
                createdAt: serverTimestamp()
            };

            try {
                const collectionRef = collection(db, `artifacts/${appId}/public/data/materiais_preparados`);
                await addDoc(collectionRef, materialData);
                showToast("Material adicionado com sucesso!", 'success');
                formMaterial.reset();
            } catch (error) {
                console.error("Erro ao adicionar material:", error);
                showToast("Erro ao adicionar o material.", 'error');
            } finally {
                btn.disabled = false;
            }
        };
        
        const deleteMaterial = async (id) => {
            if (!db) return;
            try {
                const docRef = doc(db, `artifacts/${appId}/public/data/materiais_preparados`, id);
                await deleteDoc(docRef);
                showToast("Registro removido.", 'info');
            } catch (error) {
                console.error("Erro ao remover material:", error);
                showToast("Erro ao remover registro.", 'error');
            }
        };
        
        const listenToMaterials = () => {
            if (!db) return;
            materialUnsubscribe();
            showLoading('material-container', true);

            const q = query(collection(db, `artifacts/${appId}/public/data/materiais_preparados`), where("date", "==", selectedDate));
            
            materialUnsubscribe = onSnapshot(q, (querySnapshot) => {
                const sortedDocs = querySnapshot.docs.sort((a,b) => (a.data().createdAt?.toDate() || 0) < (b.data().createdAt?.toDate() || 0) ? 1 : -1);

                tabelaMaterialBody.innerHTML = '';
                if(querySnapshot.empty){
                    tabelaMaterialBody.innerHTML = `<tr><td colspan="14" class="text-center p-4 text-[#6B7280]">Nenhum material preparado para esta data.</td></tr>`;
                } else {
                    sortedDocs.forEach((doc) => {
                        const data = doc.data();
                        const row = document.createElement('tr');
                        row.className = 'hover:bg-[#F9FAFB]';
                        row.innerHTML = `
                            <td class="px-4 py-3 text-sm text-[#374151]">${data.preparador || '-'}</td>
                            <td class="px-4 py-3 text-sm text-[#374151]">${data.maquina}</td>
                            <td class="px-4 py-3 text-sm text-[#374151]">${data.codProduto || '-'}</td>
                            <td class="px-4 py-3 text-sm text-[#374151]">${data.op || '-'}</td>
                            <td class="px-4 py-3 text-sm font-medium text-[#1F2937]">${data.nomePeca}</td>
                            <td class="px-4 py-3 text-sm text-[#374151] text-center">${data.qtdMat || '-'}</td>
                            <td class="px-4 py-3 text-sm text-[#374151]">${data.skResina || '-'}</td>
                            <td class="px-4 py-3 text-sm text-[#374151]">${data.loteResina || '-'}</td>
                            <td class="px-4 py-3 text-sm text-[#374151]">${data.skMaster || '-'}</td>
                            <td class="px-4 py-3 text-sm text-[#374151]">${data.loteMaster || '-'}</td>
                            <td class="px-4 py-3 text-sm text-[#374151]">${data.skAditivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-[#374151]">${data.loteAdit || '-'}</td>
                            <td class="px-4 py-3 text-sm text-[#374151] text-center">${data.percentUsado || '-'}</td>
                            <td class="px-4 py-3 text-center no-print">
                                <button data-id="${doc.id}" data-peca="${data.nomePeca}" class="delete-material-btn text-[#DC2626] hover:text-[#B91C1C] p-1">
                                    <i data-lucide="trash-2" class="w-4 h-4"></i>
                                </button>
                            </td>
                        `;
                        tabelaMaterialBody.appendChild(row);
                    });
                }
                lucide.createIcons();
                showLoading('material-container', false);
            }, (error) => {
                console.error("Erro no listener de materiais:", error);
                showToast("Erro de conexão com a tabela de materiais.", 'error');
                showLoading('material-container', false);
            });
        };

        const initialize = async () => {
            let app;
            try {
                app = initializeApp(firebaseConfig);
            } catch(e) {
                console.error("Falha ao inicializar o Firebase:", e);
                updateConnectionStatus("Erro de Configuração", "bg-[#DC2626]");
                showToast("Configuração do Firebase inválida.", 'error');
                return;
            }

            db = getFirestore(app);
            auth = getAuth(app);
            
            try {
                await signInAnonymously(auth);
            } catch(error) {
                console.error("Erro na autenticação:", error);
                updateConnectionStatus("Falha na Autenticação", "bg-[#DC2626]");
                let userMessage = `Erro na autenticação: ${error.message}.`;
                if (error.code === 'auth/configuration-not-found') {
                    userMessage = "Falha na autenticação: O login anónimo não está ativado no seu projeto Firebase. Por favor, ative-o na consola do Firebase -> Authentication -> Sign-in method.";
                }
                showToast(userMessage, 'error');
                return;
            }

            onAuthStateChanged(auth, (user) => {
                if (user) {
                    userId = user.uid;
                    updateConnectionStatus("Conectado em tempo real", "bg-[#16A34A]");
                    loadAllDataForDate();
                } else {
                    userId = null;
                    updateConnectionStatus("Desconectado", "bg-[#DC2626]");
                    materialUnsubscribe();
                }
            });
        };

        const loadAllDataForDate = () => {
            loadCicloData();
            listenToMaterials();
        };

        const populateDropdowns = () => {
            const maquinas = [
                'H-01', 'H-02', 'H-03', 'H-04', 'H-05', 'H-06', 'H-07', 'H-08', 'H-09', 'H-10', 
                'H-11', 'H-12', 'H-13', 'H-14', 'H-15', 'H-16', 'H-17', 'H-18', 'H-19', 'H-20', 
                'H-26', 'H-27', 'H-28', 'H-29', 'H-30', 'H-31', 'H-32'
            ];
            const preparadores = ['Daniel', 'João', 'Luis', 'Manaus', 'Rafael', 'Stanley', 'Wagner', 'Yohan'].sort();

            const maquinaPrepSelect = document.getElementById('maquina-prep');
            maquinas.forEach(maq => {
                const option = document.createElement('option');
                option.value = maq;
                option.textContent = maq;
                maquinaPrepSelect.appendChild(option);
            });

            const preparadorSelect = document.getElementById('preparador');
            preparadores.forEach(nome => {
                const option = document.createElement('option');
                option.value = nome;
                option.textContent = nome;
                preparadorSelect.appendChild(option);
            });
        };

        const setupEventListeners = () => {
            dateSelector.value = selectedDate;
            dateSelector.addEventListener('change', (e) => {
                selectedDate = e.target.value;
                loadAllDataForDate();
            });

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    const target = document.querySelector(button.dataset.target);
                    pageSections.forEach(section => section.classList.add('hidden'));
                    target.classList.remove('hidden');
                });
            });

            printBtn.addEventListener('click', () => {
                const printDateSpans = document.querySelectorAll('.print-date');
                const formattedDate = new Date(selectedDate + 'T00:00:00').toLocaleDateString('pt-BR', { timeZone: 'UTC' });
                printDateSpans.forEach(span => span.textContent = formattedDate);
                document.getElementById('print-observacoes').textContent = obsTextarea.value;
                window.print();
            });

            cicloForm.addEventListener('submit', saveCicloData);
            
            machineSelector.addEventListener('change', () => {
                const selectedMachine = machineSelector.value;
                if(selectedMachine){
                    populateCicloForm(selectedMachine);
                } else {
                    clearAndDisableCicloForm();
                }
            });
            
            // Função para buscar nome do produto pelo código
            const buscarNomeProduto = (codigo) => {
                return produtosDatabase[codigo] || '';
            };

            // Event listener para código do produto no formulário de ciclo
            codProdutoInput.addEventListener('input', (e) => {
                const codigo = e.target.value.trim();
                const nomeProduto = buscarNomeProduto(codigo);
                nomePecaInput.value = nomeProduto;
            });

            // Event listener para código do produto no formulário de material
            codProdutoMaterial.addEventListener('input', (e) => {
                const codigo = e.target.value.trim();
                const nomeProduto = buscarNomeProduto(codigo);
                nomePecaMaterial.value = nomeProduto;
            });
            
            const qtdTotalOpInput = cicloFields.querySelector('[data-col="qtd_total_op"]');
            const qtdRealInput = cicloFields.querySelector('[data-col="qtd_real"]');
            const fimInput = cicloFields.querySelector('[data-col="fim"]');

            const calculateSaldo = () => {
                const total = parseFloat(qtdTotalOpInput.value.replace(',', '.')) || 0;
                const real = parseInt(qtdRealInput.value, 10) || 0;
                fimInput.value = total - real;
            };

            qtdTotalOpInput.addEventListener('input', calculateSaldo);
            qtdRealInput.addEventListener('input', calculateSaldo);
            
            formMaterial.addEventListener('submit', addMaterial);

            document.getElementById('material-container').addEventListener('click', e => {
                const deleteBtn = e.target.closest('.delete-material-btn');
                if(deleteBtn) {
                    const id = deleteBtn.dataset.id;
                    const peca = deleteBtn.dataset.peca;
                    const modal = document.getElementById('confirm-modal');
                    modal.querySelector('#confirm-modal-text').textContent = `Isso removerá permanentemente o registro do material para a peça "${peca}".`;
                    modal.classList.remove('hidden');
                    const okBtn = modal.querySelector('#confirm-modal-ok-btn');
                    const cancelBtn = modal.querySelector('#confirm-modal-cancel-btn');
                    const handleOkClick = () => { deleteMaterial(id); closeModal(); };
                    const closeModal = () => { modal.classList.add('hidden'); okBtn.removeEventListener('click', handleOkClick); };
                    okBtn.addEventListener('click', handleOkClick, { once: true });
                    cancelBtn.addEventListener('click', closeModal, { once: true });
                }
            });

            tabelaCicloBody.addEventListener('click', (e) => {
                const deleteBtn = e.target.closest('.delete-ciclo-btn');
                if (deleteBtn) {
                    const maq = deleteBtn.dataset.maq;
                    const modal = document.getElementById('confirm-modal');
                    modal.querySelector('#confirm-modal-text').textContent = `Isso removerá permanentemente o lançamento de ciclo para a máquina "${maq}".`;
                    modal.classList.remove('hidden');
                    const okBtn = modal.querySelector('#confirm-modal-ok-btn');
                    const cancelBtn = modal.querySelector('#confirm-modal-cancel-btn');
                    const handleOkClick = () => { deleteCicloEntry(maq); closeModal(); };
                    const closeModal = () => { modal.classList.add('hidden'); okBtn.removeEventListener('click', handleOkClick); };
                    okBtn.addEventListener('click', handleOkClick, { once: true });
                    cancelBtn.addEventListener('click', closeModal, { once: true });
                }
            });
        };

        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
            populateDropdowns();
            setupEventListeners();
            initialize();
        });
    </script>
</body>
</html>


